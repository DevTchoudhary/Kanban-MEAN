/*!
*  filename: ej2-kanban.umd.min.js
*  version : 27.1.48
*  Copyright Syncfusion Inc. 2001 - 2023. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base"),require("@syncfusion/ej2-popups"),require("@syncfusion/ej2-data"),require("@syncfusion/ej2-dropdowns"),require("@syncfusion/ej2-inputs"),require("@syncfusion/ej2-buttons"),require("@syncfusion/ej2-navigations")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base","@syncfusion/ej2-popups","@syncfusion/ej2-data","@syncfusion/ej2-dropdowns","@syncfusion/ej2-inputs","@syncfusion/ej2-buttons","@syncfusion/ej2-navigations"],t):t((e=e||self).ej={},e.ej2Base,e.ej2Popups,e.ej2Data,e.ej2Dropdowns,e.ej2Inputs,e.ej2Buttons,e.ej2Navigations)}(this,function(e,f,P,s,N,H,I,B){"use strict";var U="actionBegin",z="actionComplete",V="actionFailure",_="cardClick",K="cardDoubleClick",W="cardRendered",Y="queryCellInfo",Q="dataBinding",X="dataBound",G="dragStart",J="drag",Z="dragStop",$="dialogOpen",ee="dialogClose",h="content-ready",i="data-ready",te="dataSourceChanged",ne="dataStateChange",ae=(t.prototype.initDataManager=function(e,t){this.dataManager=e instanceof s.DataManager?e:new s.DataManager(e),this.query=t instanceof s.Query?t:new s.Query,this.kanbanData=new s.DataManager(this.parent.kanbanData)},t.prototype.isRemote=function(){return!0!==this.dataManager.dataSource.offline&&void 0!==this.dataManager.dataSource.url&&""!==this.dataManager.dataSource.url},t.prototype.columnKeyFields=function(){for(var e=[],t=0,n=this.parent.columns;t<n.length;t++){var a=n[t];if(1<a.keyField.toString().split(",").length)for(var r=0,i=a.keyField.toString().split(",");r<i.length;r++){var o=i[r];e.push(o.trim())}else e.push(a.keyField.toString())}return e},t.prototype.getQuery=function(e){var t=this.query.clone();if(this.isRemote()&&this.parent.enableVirtualization){for(var n="auto"===this.parent.cardHeight?100:parseInt(f.formatUnit(this.parent.cardHeight).split("px")[0],10),n="auto"===this.parent.height?2*Math.ceil(window.innerHeight/n):2*Math.ceil(parseInt(f.formatUnit(this.parent.height).split("px")[0],10)/n),a=this.columnKeyFields(),r=0;r<a.length;r++)t.where(this.parent.keyField,"equal",a[r]);t.take(n),f.isNullOrUndefined(e)&&(e="KanbanVirtualization"),t.addParams("KanbanVirtualization",e)}return t},t.prototype.getData=function(e){var t;return this.parent.dataSource&&"result"in this.parent.dataSource?(t=this.eventPromise({requestType:""},e),this.isObservable=!0,t.promise):this.dataManager.executeQuery(e)},t.prototype.setState=function(e){return this.dataState=e},t.prototype.getStateEventArgument=function(e){var t=new s.UrlAdaptor,n=new s.DataManager({url:"",adaptor:new s.UrlAdaptor}),t=t.processQuery(n,e),n=JSON.parse(t.data);return f.extend(n,t.pvtData)},t.prototype.eventPromise=function(e,t,n){var a,r=this,i=e,o=this.getStateEventArgument(t),l=new s.Deferred,t=new s.Deferred;return void 0!==e.requestType&&!1!==this.dataState.isDataChanged?"cardChanged"===(o.action=e).requestType||"cardRemoved"===e.requestType||"cardCreated"===e.requestType?((a=e).promise=t.promise,a.state=o,a.index=n,this.setState({isPending:!0,resolver:t.resolve}),i.endEdit=t.resolve,i.cancelEdit=t.reject,this.parent.trigger(te,a),t.promise.then(function(){r.setState({isPending:!0,resolver:l.resolve}),r.parent.trigger(ne,o),a.addedRecords.forEach(function(e){r.parent.kanbanData.push(e)}),a.changedRecords.forEach(function(t){var e=r.parent.kanbanData.filter(function(e){return e[r.parent.cardSettings.headerField]===t[r.parent.cardSettings.headerField]})[0];f.extend(e,t)}),a.deletedRecords.forEach(function(t){var e=r.parent.kanbanData.findIndex(function(e){return e[r.parent.cardSettings.headerField]===t[r.parent.cardSettings.headerField]});r.parent.kanbanData.splice(e,1)})}).catch(function(){r.parent.hideSpinner()})):(this.setState({isPending:!0,resolver:l.resolve}),this.parent.trigger(ne,o)):(this.setState({}),l.resolve(this.parent.dataSource)),l},t.prototype.getTable=function(){return this.parent.query?this.getQuery().fromTable:null},t.prototype.refreshDataManager=function(){var t=this;this.getData(this.getQuery()).then(function(e){return t.dataManagerSuccess(e)}).catch(function(e){return t.dataManagerFailure(e)})},t.prototype.dataManagerSuccess=function(e,t,n,a){var r=this;this.parent.isDestroyed||(t?(this.updateKanbanData(e),this.parent.enableVirtualization&&this.isRemote()&&this.parent.virtualLayoutModule.refresh()):this.parent.trigger(Q,e,function(e){r.updateKanbanData(e),r.parent.notify(i,{processedData:r.parent.kanbanData}),r.parent.trigger(X,null,function(){return r.parent.hideSpinner()})}),this.initload&&(this.parent.layoutModule.refresh(),this.parent.renderTemplates()),this.initload=!0)},t.prototype.updateKanbanData=function(e){var t=f.extend([],(f.isNullOrUndefined(e.result.result)?e:e.result).result,null,!0);if(this.isRemote()&&this.parent.enableVirtualization&&0<t.length&&!f.isNullOrUndefined(e.result.count))for(var n=this.columnKeyFields(),a=0;a<n.length;a++)e.result.count[a].Key===n[a]&&(this.parent.columnDataCount[n[a]]=e.result.count[a].Value);this.parent.kanbanData=t},t.prototype.dataManagerFailure=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger(V,{error:e},function(){return t.parent.hideSpinner()})},t.prototype.updateDataManager=function(a,r,e,i,o,l,s,d,c,p){var h,u=this,e=(this.parent.showSpinner(),{requestType:e,cancel:!1,addedRecords:r.addedRecords,changedRecords:r.changedRecords,deletedRecords:r.deletedRecords});this.setState({isDataChanged:!0}),this.eventPromise(e,this.query,o),this.parent.trigger(z,e,function(t){if(!t.cancel){switch(a){case"insert":h=u.dataManager.insert(i,u.getTable(),u.getQuery());break;case"update":h=u.parent.enableVirtualization&&!u.parent.dataModule.isRemote()&&l?(h=u.dataManager.remove(u.keyField,i,u.getTable(),u.getQuery()),u.dataManager.insert(i,u.getTable(),u.getQuery(),u.dataManager.dataSource.json.findIndex(function(e){return e[u.parent.cardSettings.headerField]===s}))):u.dataManager.update(u.keyField,i,u.getTable(),u.getQuery());break;case"delete":h=u.dataManager.remove(u.keyField,i,u.getTable(),u.getQuery());break;case"batch":if(!u.parent.dataModule.isRemote()&&l&&u.parent.enableVirtualization&&i){for(var e=0;e<i.length;e++)h=u.dataManager.remove(u.keyField,i[e],u.getTable(),u.getQuery());for(var n=u.dataManager.dataSource.json.findIndex(function(e){return e[u.parent.cardSettings.headerField]===s}),e=0;e<i.length;e++,n++)h=u.dataManager.insert(i[e],u.getTable(),u.getQuery(),n)}else h=u.dataManager.saveChanges(r,u.keyField,u.getTable(),u.getQuery())}u.dataManager.dataSource.offline?u.isObservable||(u.kanbanData=u.dataManager,u.parent.kanbanData=u.dataManager.dataSource.json,o=d===c&&p?o-1:o,u.refreshUI(t,o,l),u.parent.enableVirtualization&&u.parent.virtualLayoutModule.refreshColumnData(d,c,t.requestType,i[u.parent.keyField])):h.then(function(e){u.parent.isDestroyed||(u.getData(u.getQuery()).then(function(e){return u.dataManagerSuccess(e,"DataSourceChange",t,o)}).catch(function(e){return u.dataManagerFailure(e)}),"cardCreated"===t.requestType?Array.isArray(e)?u.modifyArrayData(t.addedRecords,e):t.addedRecords[0]=f.extend(t.addedRecords[0],e):"cardChanged"===t.requestType?Array.isArray(e)?u.modifyArrayData(t.changedRecords,e):t.changedRecords[0]=f.extend(t.changedRecords[0],e):"cardRemoved"===t.requestType&&(Array.isArray(e)?u.modifyArrayData(t.deletedRecords,e):t.deletedRecords[0]=f.extend(t.deletedRecords[0],e)),o=d===c&&p?o-1:o,u.refreshUI(t,o,l),u.parent.enableVirtualization&&u.parent.virtualLayoutModule.refreshColumnData(d,c,t.requestType,i[u.parent.keyField]))}).catch(function(e){u.dataManagerFailure(e)})}})},t.prototype.modifyArrayData=function(e,t){if(e.length===t.length)for(var n=0;n<t.length;n++)e[n]=f.extend(e[n],t[n]);return e},t.prototype.refreshUI=function(n,a,r){var i=this;(this.parent.enableVirtualization?(this.parent.virtualLayoutModule.columnData=this.parent.virtualLayoutModule.getColumnCards(),n.addedRecords.forEach(function(e,t){i.parent.virtualLayoutModule.renderCardBasedOnIndex(e,a+t,r,n.requestType)}),n.changedRecords.forEach(function(e){i.parent.virtualLayoutModule.removeCard(e),i.parent.virtualLayoutModule.renderCardBasedOnIndex(e,a,r,n.requestType),i.parent.virtualLayoutModule.isSelectedCard&&i.parent.actionModule.SingleCardSelection(e),i.parent.sortSettings.field&&"Index"===i.parent.sortSettings.sortBy&&"Descending"===i.parent.sortSettings.direction&&0<a?--a:a++}),n.deletedRecords.forEach(function(e){i.parent.virtualLayoutModule.removeCard(e)}),this.parent.virtualLayoutModule):(this.parent.layoutModule.columnData=this.parent.layoutModule.getColumnCards(),this.parent.swimlaneSettings.keyField&&(this.parent.layoutModule.kanbanRows=this.parent.layoutModule.getRows(),this.parent.layoutModule.swimlaneData=this.parent.layoutModule.getSwimlaneCards()),n.addedRecords.forEach(function(e,t){i.parent.swimlaneSettings.keyField&&!e[i.parent.swimlaneSettings.keyField]&&(e[i.parent.swimlaneSettings.keyField]=""),i.parent.layoutModule.renderCardBasedOnIndex(e,a+t)}),n.changedRecords.forEach(function(e){i.parent.swimlaneSettings.keyField&&!e[i.parent.swimlaneSettings.keyField]&&(e[i.parent.swimlaneSettings.keyField]=""),i.parent.layoutModule.removeCard(e),i.parent.layoutModule.renderCardBasedOnIndex(e,a),i.parent.layoutModule.isSelectedCard&&i.parent.actionModule.SingleCardSelection(e),i.parent.sortSettings.field&&"Index"===i.parent.sortSettings.sortBy&&"Descending"===i.parent.sortSettings.direction&&0<a?--a:a++}),n.deletedRecords.forEach(function(e){i.parent.layoutModule.removeCard(e)}),this.parent.layoutModule)).refresh(),this.parent.renderTemplates(),this.parent.notify(h,{}),this.parent.trigger(X,n,function(){return i.parent.hideSpinner()})},t);function t(e){this.initload=!1,this.dataState={isPending:!1,resolver:null,isDataChanged:!1},this.parent=e,this.keyField=this.parent.cardSettings.headerField,this.dataState={isDataChanged:!1},this.isObservable=!1,this.initDataManager(e.dataSource,e.query),this.refreshDataManager()}re=function(e,t){return(re=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};var re,ie,oe=function(e,t){function n(){this.constructor=e}re(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},n=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(o=(i<3?r(o):3<i?r(t,n,o):r(t,n))||o);return 3<i&&o&&Object.defineProperty(t,n,o),o},oe=(ie=f.ChildProperty,oe(a,ie),n([f.Property()],a.prototype,"keyField",void 0),n([f.Property()],a.prototype,"textField",void 0),n([f.Property(!1)],a.prototype,"showEmptyRow",void 0),n([f.Property(!0)],a.prototype,"showItemCount",void 0),n([f.Property(!1)],a.prototype,"allowDragAndDrop",void 0),n([f.Property()],a.prototype,"template",void 0),n([f.Property("Ascending")],a.prototype,"sortDirection",void 0),n([f.Property()],a.prototype,"sortComparer",void 0),n([f.Property(!0)],a.prototype,"showUnassignedRow",void 0),n([f.Property(!1)],a.prototype,"enableFrozenRows",void 0),a);function a(){return null!==ie&&ie.apply(this,arguments)||this}le=function(e,t){return(le=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};var le,se,n=function(e,t){function n(){this.constructor=e}le(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(o=(i<3?r(o):3<i?r(t,n,o):r(t,n))||o);return 3<i&&o&&Object.defineProperty(t,n,o),o},n=(se=f.ChildProperty,n(o,se),r([f.Property(!0)],o.prototype,"showHeader",void 0),r([f.Property()],o.prototype,"headerField",void 0),r([f.Property()],o.prototype,"contentField",void 0),r([f.Property()],o.prototype,"tagsField",void 0),r([f.Property()],o.prototype,"grabberField",void 0),r([f.Property()],o.prototype,"footerCssField",void 0),r([f.Property()],o.prototype,"template",void 0),r([f.Property("Single")],o.prototype,"selectionType",void 0),o);function o(){return null!==se&&se.apply(this,arguments)||this}de=function(e,t){return(de=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};var de,ce,r=function(e,t){function n(){this.constructor=e}de(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},pe=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(o=(i<3?r(o):3<i?r(t,n,o):r(t,n))||o);return 3<i&&o&&Object.defineProperty(t,n,o),o},r=(ce=f.ChildProperty,r(he,ce),pe([f.Property()],he.prototype,"template",void 0),pe([f.Property([])],he.prototype,"fields",void 0),pe([f.Property(null)],he.prototype,"model",void 0),he);function he(){return null!==ce&&ce.apply(this,arguments)||this}ue=function(e,t){return(ue=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};var ue,ge,pe=function(e,t){function n(){this.constructor=e}ue(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},l=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(o=(i<3?r(o):3<i?r(t,n,o):r(t,n))||o);return 3<i&&o&&Object.defineProperty(t,n,o),o},me=(ge=f.ChildProperty,pe(d,ge),l([f.Property()],d.prototype,"keyField",void 0),l([f.Property()],d.prototype,"headerText",void 0),l([f.Property()],d.prototype,"template",void 0),l([f.Property(!1)],d.prototype,"allowToggle",void 0),l([f.Property(!0)],d.prototype,"isExpanded",void 0),l([f.Property()],d.prototype,"minCount",void 0),l([f.Property()],d.prototype,"maxCount",void 0),l([f.Property(!0)],d.prototype,"showItemCount",void 0),l([f.Property(!1)],d.prototype,"showAddButton",void 0),l([f.Property(!0)],d.prototype,"allowDrag",void 0),l([f.Property(!0)],d.prototype,"allowDrop",void 0),l([f.Property([])],d.prototype,"transitionColumns",void 0),d);function d(){return null!==ge&&ge.apply(this,arguments)||this}ye=function(e,t){return(ye=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};var ye,fe,pe=function(e,t){function n(){this.constructor=e}ye(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},l=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(o=(i<3?r(o):3<i?r(t,n,o):r(t,n))||o);return 3<i&&o&&Object.defineProperty(t,n,o),o},pe=(fe=f.ChildProperty,pe(ve,fe),l([f.Property()],ve.prototype,"text",void 0),l([f.Property()],ve.prototype,"keyFields",void 0),ve);function ve(){return null!==fe&&fe.apply(this,arguments)||this}be=function(e,t){return(be=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};var be,Se,l=function(e,t){function n(){this.constructor=e}be(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},Ce=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(o=(i<3?r(o):3<i?r(t,n,o):r(t,n))||o);return 3<i&&o&&Object.defineProperty(t,n,o),o},l=(Se=f.ChildProperty,l(we,Se),Ce([f.Property("Index")],we.prototype,"sortBy",void 0),Ce([f.Property()],we.prototype,"field",void 0),Ce([f.Property("Ascending")],we.prototype,"direction",void 0),we);function we(){return null!==Se&&Se.apply(this,arguments)||this}var Ee="e-kanban",ke="e-rtl",Oe="e-device",xe="e-icons",De="e-template",Ae="e-swimlane",Fe="e-kanban-table",c="e-kanban-header",Me="e-header-table",p="e-header-cells",Te="e-header-wrap",je="e-header-title",qe="e-header-text",Re="e-header-icon",Le="e-stacked-header-row",Pe="e-stacked-header-cell",u="e-content-cells",g="e-kanban-content",Ne="e-content-table",He="e-toggle-header",Ie="e-header-row",m="e-content-row",y="e-swimlane-row",Be="e-swimlane-row-expand",v="e-swimlane-row-collapse",Ue="e-item-count",b="e-card-wrapper",ze="e-card-virtual-wrapper",S="e-card",C="e-droppable",Ve="e-drag",_e="e-drop",Ke="e-disabled",We="e-card-header",Ye="e-card-content",Qe="e-card-header-caption",Xe="e-card-header-title",Ge="e-card-tags",Je="e-card-tag",Ze="e-card-color",$e="e-card-label",et="e-card-footer",tt="e-empty-card",nt="e-card-footer-css",at="e-column-expand",rt="e-column-collapse",it="e-collapse-header-text",w="e-collapsed",ot="e-kanban-dialog",lt="e-kanban-form",st="e-kanban-error",dt="e-field",ct="e-target-dragged-clone",pt="e-cloned-card",ht="e-kanban-dragged-card",ut="e-target-dropped-clone",E="e-dropping",gt="e-kanban-border",mt="e-toggle-visible",yt="e-multi-card-wrapper",ft="e-target-multi-clone",vt="e-column-key",k="e-selection",bt="e-tooltip-text",O="e-swimlane-header",St="e-icon-menu",Ct="e-toolbar-swimlane-name",wt="e-swimlane-overlay",Et="e-swimlane-content",kt="e-swimlane-resource",Ot="e-limits",xt="e-max-count",Dt="e-min-count",At="e-max-color",Ft="e-min-color",Mt="e-close",Tt="e-popup-content",x="e-show-add-button",jt="e-show-add-icon",qt="e-show-add-focus",Rt="e-frozen-swimlane-row",Lt="e-frozen-row",Pt=(D.prototype.clickHandler=function(e){var t,n=f.closest(e.target,".e-card,.e-header-icon,.e-content-row.e-swimlane-row,.e-show-add-button,.e-frozen-swimlane-row,.e-content-row:not(.e-swimlane-row) .e-content-cells");n&&(n.classList.contains(S)?(this.parent.allowKeyboard&&this.parent.keyboardModule.cardTabIndexRemove(),this.cardClick(e)):n.classList.contains(Re)?this.columnExpandCollapse(e):n.classList.contains(m)&&n.classList.contains(y)?this.rowExpandCollapse(e):n.classList.contains(x)?this.addButtonClick(n):n.classList.contains(Rt)&&(n=[].slice.call(this.parent.element.querySelectorAll("."+y)),t=this.parent.layoutModule.frozenSwimlaneRow.querySelector("."+xe),this.rowExpandCollapse(e,n[this.parent.layoutModule.frozenOrder]),!!t.classList.contains(v)?f.classList(t,[Be],[v]):f.classList(t,[v],[Be])))},D.prototype.addButtonClick=function(e){var t,n=this,a={};0===this.parent.kanbanData.length?a[this.parent.cardSettings.headerField]=1:"number"==typeof this.parent.kanbanData[0][this.parent.cardSettings.headerField]&&(t=this.parent.kanbanData.map(function(e){return parseInt(e[n.parent.cardSettings.headerField],10)}),a[this.parent.cardSettings.headerField]=Math.max.apply(Math,t)+1),a[this.parent.keyField]=f.closest(e,"."+u).getAttribute("data-key"),"Index"===this.parent.sortSettings.sortBy&&(a[this.parent.sortSettings.field]=1,f.closest(e,"."+u).querySelector("."+S))&&(t="Ascending"===this.parent.sortSettings.direction?(e.nextElementSibling.classList.contains(gt)?e.nextElementSibling:e).nextElementSibling.lastElementChild:(e.nextElementSibling.classList.contains(gt)?e.nextElementSibling:e).nextElementSibling.firstElementChild,t=this.parent.getCardDetails(t),a[this.parent.sortSettings.field]=t[this.parent.sortSettings.field]+1),0!==this.parent.kanbanData.length&&this.parent.swimlaneSettings.keyField&&f.closest(e,"."+m).previousElementSibling&&(a[this.parent.swimlaneSettings.keyField]=f.closest(e,"."+m).previousElementSibling.getAttribute("data-key")),this.parent.openDialog("Add",a)},D.prototype.doubleClickHandler=function(e){f.closest(e.target,"."+S)&&this.cardDoubleClick(e)},D.prototype.cardClick=function(t,e){var n=this,a=f.closest(e||t.target,"."+S),e=this.parent.getCardDetails(a);e&&(this.parent.activeCardData={data:e,element:a},this.parent.trigger(_,{data:e,element:a,cancel:!1,event:t},function(e){e.cancel||(a.classList.contains(k)&&"click"===t.type?(f.removeClass([a],k),(n.parent.enableVirtualization?n.parent.virtualLayoutModule:n.parent.layoutModule).disableAttributeSelection(a)):(e=t.ctrlKey,n.parent.isAdaptive&&n.parent.touchModule&&(e=n.parent.touchModule.mobilePopup&&n.parent.touchModule.tabHold||e),n.cardSelection(a,e,t.shiftKey)),n.parent.isAdaptive&&n.parent.touchModule&&n.parent.touchModule.updatePopupContent(),e=f.closest(a,"."+u),n.parent.allowKeyboard&&([].slice.call(e.querySelectorAll("."+S)).forEach(function(e){e.setAttribute("tabindex","0")}),n.parent.keyboardModule.addRemoveTabIndex("Remove")))}))},D.prototype.cardDoubleClick=function(e){var t=this,n=f.closest(e.target,"."+S),a=this.parent.getCardDetails(n),r=(this.parent.activeCardData={data:a,element:n},this.cardSelection(n,!1,!1),{data:a,element:n,cancel:!1,event:e});this.parent.trigger(K,r,function(e){e.cancel||t.parent.dialogModule.openDialog("Edit",r.data)})},D.prototype.rowExpandCollapse=function(e,t){var o=this,l=e instanceof HTMLElement?e:e.target,s=f.isNullOrUndefined(t)?l:t;this.parent.trigger(U,{cancel:!1,target:l,requestType:"rowExpandCollapse"},function(e){var t,n,a,r,i;e.cancel||(t=(e=f.closest(s,"."+y)).getAttribute("data-key"),n=o.parent.element.querySelector("."+m+":nth-child("+(e.rowIndex+2)+")"),a=e.querySelector("."+Be+",."+v),r=!!e.classList.contains(w),i=r?(f.removeClass([n,e],w),f.classList(a,[Be],[v]),o.parent.swimlaneToggleArray.splice(o.parent.swimlaneToggleArray.indexOf(t),1),"0"):(f.addClass([n,e],w),f.classList(a,[v],[Be]),o.parent.swimlaneToggleArray.push(t),"-1"),a.setAttribute("aria-label",r?t+" Expand":t+" Collapse"),e.setAttribute("aria-expanded",r.toString()),n.setAttribute("aria-expanded",r.toString()),[].slice.call(n.querySelectorAll("."+u)).forEach(function(e){e.setAttribute("tabindex",i)}),o.parent.notify(h,{}),o.parent.trigger(z,{target:l,requestType:"rowExpandCollapse"}))})},D.prototype.columnExpandCollapse=function(e){var n=this,a=e instanceof HTMLElement?e:e.target;this.parent.trigger(U,{cancel:!1,target:a,requestType:"columnExpandCollapse"},function(e){var t;e.cancel||(t=(e=f.closest(a,"."+p)).cellIndex,n.columnToggle(e),(e=n.parent.element.querySelectorAll("."+p+"."+w).length)===n.parent.columns.length-n.hideColumnKeys.length&&(e=n.parent.element.querySelector("."+p+":not(."+Pe+"):nth-child("+(t+1===e?1:t+2)+")"),f.addClass([e],w),n.columnToggle(e)),n.parent.notify(h,{}),n.parent.trigger(z,{target:a,requestType:"columnExpandCollapse"}))})},D.prototype.columnToggle=function(r){var t=this,n=r.cellIndex,e=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),a="."+Fe+" col:nth-child("+(n+1)+")",i=r.querySelector("."+at+",."+rt),a=[].slice.call(this.parent.element.querySelectorAll(a));if(r.classList.contains(w)){f.removeClass(a,w),this.parent.isAdaptive&&(this.parent.enableVirtualization?a.forEach(function(e){return e.style.width=f.formatUnit(t.parent.virtualLayoutModule.getWidth())}):a.forEach(function(e){return e.style.width=f.formatUnit(t.parent.layoutModule.getWidth())})),f.classList(i,[at],[rt]);for(var o=0,l=e;o<l.length;o++)!function(e){var t=e.querySelector("."+u+":nth-child("+(n+1)+")");f.removeClass([t,r],w),f.remove(t.querySelector("."+it)),r.setAttribute("aria-expanded","true"),t.setAttribute("aria-expanded","true"),[].slice.call(t.parentElement.querySelectorAll("."+w)).forEach(function(e){e=e.querySelector("."+it);e.style.height="auto",e&&t.getBoundingClientRect().height<e.getBoundingClientRect().height+10&&(e.style.height=t.getBoundingClientRect().height-4+"px")})}(l[o]);0===this.parent.kanbanData.length&&0===e.length&&(f.removeClass([r],w),r.setAttribute("aria-expanded","true")),this.columnToggleArray.splice(this.columnToggleArray.indexOf(r.getAttribute("data-key")),1),this.parent.columns[n].setProperties({isExpanded:!0},!0),r.querySelector(".e-header-icon").setAttribute("aria-label",r.getAttribute("data-key")+" Expand")}else{f.addClass(a,w),this.parent.isAdaptive&&a.forEach(function(e){return e.style.width=f.formatUnit(50)}),f.classList(i,[rt],[at]);for(var s=r.getAttribute("data-key"),d=this,c=0,p=e;c<p.length;c++)!function(e){var t,n=e.querySelector("."+u+'[data-key="'+s+'"]'),e=n.cellIndex,a=void 0;a=d.parent.enableVirtualization?(t=d.parent.dataModule.isRemote()?d.parent.columnDataCount[d.parent.columns[e].keyField]:d.parent.virtualLayoutModule.columnData[d.parent.columns[e].keyField].length,(d.parent.columns[e].showItemCount?"["+t+"] ":"")+d.parent.columns[e].headerText):(d.parent.columns[e].showItemCount?"["+n.querySelectorAll("."+S).length+"] ":"")+d.parent.columns[e].headerText,n.appendChild(f.createElement("div",{className:it,innerHTML:a})),f.addClass([n,r],w),r.setAttribute("aria-expanded","false"),n.setAttribute("aria-expanded","false"),[].slice.call(n.parentElement.querySelectorAll("."+w)).forEach(function(e){e=e.querySelector("."+it);e&&n.getBoundingClientRect().height<e.getBoundingClientRect().height+10&&(e.style.height=n.getBoundingClientRect().height-4+"px")})}(p[c]);0===this.parent.kanbanData.length&&0===e.length&&(f.addClass([r],w),r.setAttribute("aria-expanded","false")),this.columnToggleArray.push(r.getAttribute("data-key")),this.parent.columns[n].setProperties({isExpanded:!1},!0),r.querySelector(".e-header-icon").setAttribute("aria-label",s+" Collapse")}},D.prototype.cardSelection=function(e,t,n){var a=this;if(e){var r=this.parent.getSelectedCards();if("None"!==this.parent.cardSettings.selectionType){var i=f.closest(e,"."+m),o=(f.isNullOrUndefined(this.lastSelectionRow)?i:this.lastSelectionRow).rowIndex;if(o===i.rowIndex||!t&&!n||"Multiple"!==this.parent.cardSettings.selectionType)if(0===r.length||t&&"Single"!==this.parent.cardSettings.selectionType||(f.removeClass(r,k),(this.parent.enableVirtualization?this.parent.virtualLayoutModule:this.parent.layoutModule).disableAttributeSelection(r),r.forEach(function(e){a.selectionArray.splice(a.selectionArray.indexOf(e.getAttribute("data-id")),1),a.selectedCardsElement.splice(a.selectedCardsElement.indexOf(e),1),a.selectedCardsData.splice(a.selectedCardsData.indexOf(a.parent.getCardDetails(e),1))})),0<r.length&&n&&"Multiple"===this.parent.cardSettings.selectionType){var l=[],s=void 0,d=void 0,c=void 0,p=[].slice.call(i.querySelectorAll("."+S)),o=(p.forEach(function(e){return l.push(e.getAttribute("data-id"))}),e.getAttribute("data-id")),t=this.lastCard.getAttribute("data-id"),r=d=l.indexOf(o),n=s=l.indexOf(t),h=n<r?"next":"prev";for("prev"==h&&(s=r,d=n),c=s;c<=d;c++){var u=p[c];f.addClass([u],k),u.setAttribute("aria-selected","true"),u.setAttribute("tabindex","0"),this.selectionArray.push(u.getAttribute("data-id")),this.selectedCardsElement.push(u),this.selectedCardsData.push(this.parent.getCardDetails(u)),this.lastCardSelection=u,"prev"==h&&(this.lastCardSelection=p[s])}}else f.addClass([e],k),e.setAttribute("aria-selected","true"),e.setAttribute("tabindex","0"),this.selectionArray.push(e.getAttribute("data-id")),this.selectedCardsElement.push(e),this.selectedCardsData.push(this.parent.getCardDetails(e)),this.lastCard=this.lastCardSelection=e,this.lastSelectionRow=f.closest(e,"."+m),this.lastSelectionRow.previousElementSibling&&(i=this.lastSelectionRow.previousElementSibling.querySelector(".e-swimlane-row-expand,.e-swimlane-row-collapse"))&&i.classList.contains(v)&&this.rowExpandCollapse(i)}}},D.prototype.addColumn=function(e,t){e=f.createInstance(me,[this.parent,"columns",e,!0]);this.parent.columns.splice(t,0,e),this.parent.notify(i,{processedData:this.parent.kanbanData})},D.prototype.deleteColumn=function(e){var t=this.parent.element.querySelectorAll("."+p).item(e);t&&t.classList.contains(He)&&this.columnToggleArray.splice(this.columnToggleArray.indexOf(t.getAttribute("data-key"),0)),this.parent.columns.splice(e,1),0===this.parent.columns.length?(f.detach(this.parent.element.querySelector("."+c)),f.detach(this.parent.element.querySelector("."+g))):this.parent.notify(i,{processedData:this.parent.kanbanData})},D.prototype.showColumn=function(e){e=this.hideColumnKeys.indexOf(e.toString());-1!==e&&(this.hideColumnKeys.splice(e,1),this.parent.notify(i,{processedData:this.parent.kanbanData}))},D.prototype.hideColumn=function(e){this.hideColumnKeys.push(e.toString()),this.parent.notify(i,{processedData:this.parent.kanbanData})},D.prototype.SingleCardSelection=function(e){"None"!==this.parent.cardSettings.selectionType&&e[this.parent.cardSettings.headerField]&&(e=this.parent.element.querySelector('.e-card[data-id="'+e[this.parent.cardSettings.headerField].toString()+'"]'))&&(f.addClass([e],k),e.setAttribute("aria-selected","true"),e.setAttribute("tabindex","0"))},D);function D(e){this.parent=e,this.columnToggleArray=[],this.selectionArray=[],this.lastCardSelection=null,this.lastSelectionRow=null,this.lastCard=null,this.selectedCardsElement=[],this.selectedCardsData=[],this.hideColumnKeys=[]}Ht.prototype.addCard=function(a,r){var i=this,e={cancel:!1,requestType:"cardCreate",addedRecords:a instanceof Array?a:[a],changedRecords:[],deletedRecords:[]};this.parent.trigger(U,e,function(e){var n,t;e.cancel||(n=[],i.parent.sortSettings.field&&"Index"===i.parent.sortSettings.sortBy&&(a instanceof Array?n=a:n.push(a),n.forEach(function(e,t){var n;e[i.parent.sortSettings.field]||(n=i.parent.getColumnData(e[i.parent.keyField]),"Ascending"===i.parent.sortSettings.direction&&0<n.length?e[i.parent.sortSettings.field]=n[n.length-1][i.parent.sortSettings.field]+t+1:"Descending"===i.parent.sortSettings.direction&&0<n.length&&(e[i.parent.sortSettings.field]=n[0][i.parent.sortSettings.field]+t+1),0===n.length&&(e[i.parent.sortSettings.field]=1))}),a instanceof Array||r||"Descending"!==i.parent.sortSettings.direction||i.parent.getColumnData(n[0][i.parent.keyField]).filter(function(e,t){e[i.parent.sortSettings.field]===n[0][i.parent.sortSettings.field]&&(r=t+1)}),0===r||r||"Descending"!==i.parent.sortSettings.direction||(r=0),n=i.priorityOrder(n,r)),e={addedRecords:a instanceof Array?a:[a],changedRecords:i.parent.sortSettings.field&&"Index"===i.parent.sortSettings.sortBy?n:[],deletedRecords:[]},t=a instanceof Array||0<n.length?"batch":"insert",i.parent.dataModule.updateDataManager(t,e,"cardCreated",a,r))})},Ht.prototype.getIndexFromData=function(e){var e=this.parent.element.querySelector('.e-card[data-id="'+e[this.parent.cardSettings.headerField]+'"]'),t=f.closest(e,"."+u);return[].slice.call(t.querySelectorAll("."+S)).indexOf(e)},Ht.prototype.updateCard=function(n,a,r,i,o,l,s){var d=this,e={requestType:"cardChange",cancel:!1,addedRecords:[],changedRecords:n instanceof Array?n:[n],deletedRecords:[]};a=f.isNullOrUndefined(a)?this.getIndexFromData(e.changedRecords[0]):a,this.parent.trigger(U,e,function(e){var t;e.cancel||(d.parent.sortSettings.field&&"Index"===d.parent.sortSettings.sortBy&&(e=[],n instanceof Array?e=n:e.push(n),n=d.priorityOrder(e,a)),e={addedRecords:[],changedRecords:n instanceof Array?n:[n],deletedRecords:[]},t=n instanceof Array?"batch":"update",d.parent.dataModule.updateDataManager(t,e,"cardChanged",n,a,r,i,o,l,s))})},Ht.prototype.deleteCard=function(t){var n=this,a={addedRecords:[],changedRecords:[],deletedRecords:[]},e=(a.deletedRecords="string"==typeof t||"number"==typeof t?this.parent.kanbanData.filter(function(e){return e[n.parent.cardSettings.headerField]===t}):t instanceof Array?t:[t],{requestType:"cardRemove",cancel:!1,addedRecords:[],changedRecords:[],deletedRecords:a.deletedRecords});this.parent.trigger(U,e,function(e){e.cancel||(e=1<a.deletedRecords.length?"batch":"delete",n.parent.dataModule.updateDataManager(e,a,"cardRemoved",a.deletedRecords[0]))})},Ht.prototype.priorityOrder=function(l,s){for(var d,c=this,p=l.map(function(e){return e[c.parent.cardSettings.headerField]}),h=l[l.length-1][this.parent.sortSettings.field],n=l.map(function(e){return e[c.parent.keyField]}),e=n.filter(function(e,t){return n.indexOf(e)===t}).sort(),u=[],g=[],t=function(t){var e=l.filter(function(e){return e[c.parent.keyField]===t});d=(m.parent.enableVirtualization?m.parent.virtualLayoutModule:m.parent.layoutModule).getColumnData(t);for(var n=0,a=e;n<a.length;n++){var r=a[n];m.parent.swimlaneSettings.keyField&&(r=m.parent.getSwimlaneData(r[m.parent.swimlaneSettings.keyField]),d=m.parent.getColumnData(t,r))}if(e.forEach(function(e){return u.push(e)}),!f.isNullOrUndefined(s)){for(var i=0;i<p.length;i++)!function(n){d.filter(function(e,t){e[c.parent.cardSettings.headerField]===p[n]&&t<=s&&g.push(t)})}(i);if(0<g.length&&(s+=g.length),"Ascending"===m.parent.sortSettings.direction)for(var o=s;o<d.length;o++)-1===p.indexOf(d[o][m.parent.cardSettings.headerField])&&(d[o][m.parent.sortSettings.field]=++h,u.push(d[o]));else for(o=s-1;0<=o;o--)-1===p.indexOf(d[o][m.parent.cardSettings.headerField])&&(d[o][m.parent.sortSettings.field]=++h,u.push(d[o]))}},m=this,a=0,r=e;a<r.length;a++)t(r[a]);return u};var Nt=Ht;function Ht(e){this.parent=e}A.prototype.wireDragEvents=function(e){var t;null!=!this.parent.element&&0===this.parent.externalDropId.length&&(t=this.parent.element.querySelector("."+g)),this.dragObj.instance=new f.Draggable(e,{clone:!0,enableTapHold:this.parent.isAdaptive,enableTailMode:!0,cursorAt:{top:-10,left:-10},dragArea:t,dragStart:this.dragStart.bind(this),drag:this.drag.bind(this),dragStop:this.dragStop.bind(this),enableAutoScroll:!1,helper:this.dragHelper.bind(this)})},A.prototype.dragHelper=function(e){if(this.parent.isAdaptive&&this.parent.touchModule.mobilePopup&&this.parent.touchModule.mobilePopup.element.classList.contains("e-popup-open")&&this.parent.touchModule.mobilePopup.hide(),this.dragObj.element=f.closest(e.sender.target,"."+S),f.isNullOrUndefined(this.dragObj.element))return null;this.dragObj.element.style.width=f.formatUnit(this.dragObj.element.offsetWidth);e=f.createElement("div",{innerHTML:this.dragObj.element.outerHTML});return this.dragObj.cloneElement=e.children.item(0),f.addClass([this.dragObj.cloneElement],pt),this.dragObj.element.parentElement.appendChild(this.dragObj.cloneElement),this.dragObj.targetCloneMulti=f.createElement("div",{className:ft}),this.dragObj.targetClone=f.createElement("div",{className:ut,styles:"width:100%;height:"+f.formatUnit(this.dragObj.element.offsetHeight)}),this.dragObj.modifiedData=[],this.dragObj.cloneElement},A.prototype.dragStart=function(t){var n=this,e=(this.dragObj.selectedCards=this.dragObj.element,this.borderElm=this.parent.element.querySelectorAll("."+gt),this.dragObj.element.classList.contains(k)?(e=f.closest(this.dragObj.element,"."+m),this.dragObj.selectedCards=[].slice.call(e.querySelectorAll(".e-card.e-selection:not(.e-cloned-card)")),this.dragObj.selectedCards.forEach(function(e){n.dragObj.cardDetails.push(n.parent.getCardDetails(e))})):this.dragObj.cardDetails=[this.parent.getCardDetails(this.dragObj.element)],!f.isNullOrUndefined(this.dragObj.selectedCards)&&!f.isNullOrUndefined(this.dragObj.selectedCards.length)&&1<=this.dragObj.selectedCards.length?this.dragObj.selectedCards[0].closest(".e-content-cells").classList.add("e-dragged-column"):f.isNullOrUndefined(this.dragObj.selectedCards)||f.isNullOrUndefined(this.dragObj.selectedCards.closest(".e-content-cells"))||this.dragObj.selectedCards.closest(".e-content-cells").classList.add("e-dragged-column"),{cancel:!1,data:this.dragObj.cardDetails,event:t,element:this.dragObj.selectedCards});this.parent.trigger(G,e,function(e){e.cancel?(n.removeElement(n.dragObj.cloneElement),n.dragObj.instance.intDestroy(t),n.dragObj.element=null,n.dragObj.targetClone=null,n.dragObj.draggedClone=null,n.dragObj.cloneElement=null,n.dragObj.targetCloneMulti=null):(n.dragObj.element.classList.contains(k)?(n.dragObj.selectedCards.forEach(function(e){n.draggedClone(e)}),1<n.dragObj.selectedCards.length&&(n.dragObj.cloneElement.innerHTML="",e=f.createElement("div",{className:"e-multi-card-text",innerHTML:n.dragObj.selectedCards.length+" "+n.parent.localeObj.getConstant("cards")}),n.dragObj.cloneElement.appendChild(e),f.classList(n.dragObj.cloneElement,["e-multi-card-clone"],[k]),(n.parent.enableVirtualization?n.parent.virtualLayoutModule:n.parent.layoutModule).disableAttributeSelection(n.dragObj.cloneElement),n.dragObj.cloneElement.style.width="90px")):n.draggedClone(n.dragObj.element),f.EventHandler.add(document.body,"keydown",n.keydownHandler,n),n.parent.notify(h,{}))})},A.prototype.draggedClone=function(e){this.dragObj.draggedClone=f.createElement("div",{className:ct,styles:"width:"+f.formatUnit(e.offsetWidth-1)+";height:"+f.formatUnit(e.offsetHeight)}),e.insertAdjacentElement("afterend",this.dragObj.draggedClone),f.addClass([e],ht)},A.prototype.drag=function(e){var t=this;if(e.target){var n,a,r=f.closest(e.target,"."+Ee+" ."+S),i=(f.isNullOrUndefined(r)||!this.parent.enableVirtualization||f.isNullOrUndefined(e.target.previousElementSibling)||f.isNullOrUndefined(e.target.previousElementSibling.querySelector(".e-target-dropped-clone"))||(r=e.target.previousElementSibling.querySelector(".e-target-dropped-clone").nextElementSibling),e.target),i=(f.isNullOrUndefined(e.target.parentElement)||("SPAN"===e.target.nodeName&&e.target.classList.contains("e-empty-card")||"DIV"===e.target.nodeName&&e.target.classList.contains("e-kanban-border")&&this.parent.element.querySelector(".e-target-dropped-clone")!==e.target.nextElementSibling.firstChild)&&(i=e.target.parentElement),r||i),o=f.closest(i,".e-content-row:not(.e-swimlane-row) .e-content-cells.e-droppable");if(i.nextElementSibling&&i.nextElementSibling.lastChild&&(d=i.nextElementSibling.lastChild.previousElementSibling),this.externalDrop(i),this.kanbanObj=this.parent.isExternalKanbanDrop?this.parent.externalDropObj:this.parent,this.calculateArgs(e),o&&"not-allowed"!==document.body.style.cursor){var l=this.getColumnKey(o),s=l.split(","),l=(this.multiCloneRemove(),l===this.getColumnKey(f.closest(this.dragObj.draggedClone,"."+u)));if(1===s.length||l)if(i.classList.contains(ct)&&this.removeElement(this.dragObj.targetClone,this.kanbanObj),i.classList.contains(S)||"beforebegin"===this.insertClone){l=i.classList.contains(ct)&&i.previousElementSibling.classList.contains(ht)?null:i.previousElementSibling;this.insertClone="afterend",f.isNullOrUndefined(l)&&(l=i.classList.contains(ct)?this.dragObj.pageY/2:this.dragObj.pageY,c=i.classList.contains(ct)?i.offsetHeight:i.offsetHeight/2,l-(this.kanbanObj.element.getBoundingClientRect().top+i.offsetTop)<c)&&(this.insertClone="beforebegin"),i.classList.contains(S)&&(this.parent.enableVirtualization&&(this.insertClone=this.isTargetElementVisible(i)?this.insertClone:"beforebegin"),i.insertAdjacentElement(this.insertClone,this.dragObj.targetClone))}else if(i.classList.contains(u)&&!f.closest(i,"."+y)){if(0!==i.querySelectorAll("."+ht).length&&0===i.querySelectorAll(".e-card:not(.e-kanban-dragged-card):not(.e-cloned-card)").length)return;i.querySelector("."+b).appendChild(this.dragObj.targetClone)}else!i.classList.contains(b)&&!i.classList.contains(ze)||f.closest(i,"."+y)||0!==o.querySelectorAll("."+S).length?!(i.classList.contains(gt)&&!f.closest(i,"."+y)&&i.nextElementSibling&&i.nextElementSibling.classList.contains(b)&&this.dragObj.targetClone)||d&&d.classList.contains(ut)||this.parent.enableVirtualization||this.isTargetElementVisible(i.nextElementSibling)||i.nextElementSibling.appendChild(this.dragObj.targetClone):i.appendChild(this.dragObj.targetClone);else 1<s.length&&(o.classList.contains(E)||o.firstChild&&o.firstChild.classList.contains(E))&&this.multiCloneCreate(s,o);this.kanbanObj.notify(h,{})}0===this.kanbanObj.element.querySelectorAll("."+E).length&&this.cellDropping();var d,l=!1,c=(o&&(l=o.classList.contains(w)&&o.classList.contains(E),"true"!==o.getAttribute("aria-expanded")&&o.parentElement.hasAttribute("aria-expanded")||(n=o.getBoundingClientRect(),this.updateDimension(n)),a=o.querySelector("."+gt)),i&&"TABLE"===i.tagName&&!f.isNullOrUndefined(i.querySelector("."+m))&&(n=i.querySelector("."+m).getBoundingClientRect(),this.updateDimension(n,i)),l&&(this.toggleVisible(i),f.addClass([o],mt)),[].slice.call(this.kanbanObj.element.querySelectorAll("."+mt))),p=(0<c.length&&!i.classList.contains(mt)&&!f.closest(i,"."+mt)&&(this.toggleVisible(i,c.slice(-1)[0]),f.removeClass(c,mt)),this.kanbanObj.notify(h,{}),f.closest(i,"."+vt)),s=(p&&0<(d=[].slice.call(this.kanbanObj.element.querySelectorAll("."+vt+":not(."+Ke+")")).filter(function(e){return t.getColumnKey(e)===t.getColumnKey(p)})).length&&(f.addClass(d,"e-multi-active"),d[0].previousElementSibling)&&f.addClass([d[0].previousElementSibling],"e-multi-bottom-border"),document.body.style.cursor=o&&o.classList.contains(E)||o&&a&&a.classList.contains(E)?"":"not-allowed",!r||f.closest(r,"."+u).classList.contains(E)||o&&a&&a.classList.contains(E)||(r.style.cursor="not-allowed",document.body.style.cursor="not-allowed"),this.isExternalDrop&&"not-allowed"===document.body.style.cursor&&(document.body.style.cursor=""),"not-allowed"===document.body.style.cursor&&(this.removeElement(this.dragObj.targetClone,this.kanbanObj),this.multiCloneRemove()),this.updateScrollPosition(),{data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards});this.kanbanObj.trigger(J,s),this.parent.isExternalKanbanDrop=!1,this.isExternalDrop=!1}},A.prototype.removeElement=function(e,t){0<(t=t||this.parent).element.getElementsByClassName(e.className).length&&f.remove(e)},A.prototype.isTargetElementVisible=function(e){var t=f.closest(e,"."+b);return!(!f.isNullOrUndefined(t)&&t.getBoundingClientRect().bottom<e.getBoundingClientRect().bottom)},A.prototype.externalDrop=function(n){var a=this;this.parent.externalDropId.forEach(function(e){var t=f.closest(n,e);t&&(t.classList.contains("e-kanban")?(a.parent.externalDropObj=document.querySelector(e).ej2_instances[0],a.parent.isExternalKanbanDrop=!0,t=[].slice.call(a.parent.externalDropObj.element.querySelectorAll(".e-content-row:not(.e-swimlane-row):not(.e-collapsed) .e-content-cells")),f.addClass(t,E)):a.isExternalDrop=!0)})},A.prototype.multiCloneCreate=function(e,t){var n=t.offsetHeight,a=t.querySelector("."+Ot);a&&(n-=a.offsetHeight),this.dragObj.targetCloneMulti.style.height=f.formatUnit(n),t.querySelector("."+x)&&f.addClass([t.querySelector("."+x)],yt),f.addClass([t.querySelector("."+b)],yt),t.querySelector("."+b).style.height="auto",t.style.borderStyle="none",this.removeElement(this.dragObj.targetClone);for(var r=0,i=e;r<i.length;r++){var o=i[r],l=f.closest(this.dragObj.draggedClone,"."+u),l=this.kanbanObj.columns[l.cellIndex].transitionColumns,l=this.allowedTransition(this.dragObj.element.getAttribute("data-key"),o,l),s=f.createElement("div",{className:vt+(l?"":" "+Ke),attrs:{"data-key":o.trim()}}),o=f.createElement("div",{className:"e-text",innerHTML:o.trim()});t.appendChild(this.dragObj.targetCloneMulti).appendChild(s).appendChild(o),s.style.cursor=l?"":"not-allowed",s.style.lineHeight=s.style.height=f.formatUnit(n/e.length),o.style.top=f.formatUnit(n/2-o.offsetHeight/2)}},A.prototype.allowedTransition=function(e,t,n){for(var a=!0,r=t.split(","),i=0;i<r.length;i++){if(e===r[i].trim())return!0;if(n){if(1===n.length&&0===n[0].length)return!0;for(var o=0;o<n.length;o++){if(r[i].trim()===n[o].trim())return!0;a=!1}}}return a},A.prototype.cellDropping=function(){var e,t=this,n=f.closest(this.dragObj.draggedClone,"."+u),a=f.closest(this.dragObj.draggedClone,"."+m);n&&n.classList.contains(_e)&&f.addClass([n],E),this.addDropping(a,n),this.kanbanObj.swimlaneSettings.keyField&&this.kanbanObj.swimlaneSettings.allowDragAndDrop&&(e=[].slice.call(this.kanbanObj.element.querySelectorAll(".e-content-row:not(.e-swimlane-row):not(.e-collapsed)")),[].slice.call(e).forEach(function(e){a!==e&&t.addDropping(e,n)}))},A.prototype.addDropping=function(e,n){var t,a=this;n&&this.borderElm&&0!==this.borderElm.length?(n.classList.contains(E)&&f.removeClass([n],E),t=n.getBoundingClientRect(),this.updateDimension(t)):n&&e&&[].slice.call(e.children).forEach(function(e){var t=a.kanbanObj.columns[n.cellIndex].transitionColumns;e!==n&&e.classList.contains(_e)&&a.allowedTransition(n.getAttribute("data-key"),e.getAttribute("data-key"),t)&&f.addClass([e],E)})},A.prototype.updateDimension=function(n,a){[].slice.call(this.borderElm).forEach(function(e){!e.parentElement||"true"!==e.parentElement.getAttribute("aria-expanded")&&e.parentElement.hasAttribute("aria-expanded")||f.addClass([e],E);var t=e.previousElementSibling;e.style.height=parseInt(n.height.toString(),10)-(t&&t.classList.contains(x)?t.offsetHeight+t.offsetTop:0)+"px",a&&"TABLE"===a.tagName||(e.style.width=parseInt(n.width.toString(),10)+"px"),e.style.left=e.parentElement.getBoundingClientRect().left-f.closest(e,".e-kanban").getBoundingClientRect().left+"px"})},A.prototype.keydownHandler=function(e){"Escape"===e.code&&this.dragObj.cloneElement&&(f.EventHandler.remove(this.dragObj.cloneElement,"keydown",this.keydownHandler),this.dragObj.element.removeAttribute("aria-grabbed"),this.dragStopClear(),this.dragStopPostClear())},A.prototype.dragStop=function(e){var r,i,o,t,n,l=this,s=f.closest(this.dragObj.targetClone,"."+u),e=(this.parent.enableVirtualization&&!f.isNullOrUndefined(s)&&s.classList.add("e-dropped-column"),f.EventHandler.remove(document.body,"keydown",this.keydownHandler),[].slice.call(this.borderElm).forEach(function(e){e.classList.remove(E)}),this.dragObj.targetClone.parentElement&&(t=(o=this.dragObj.selectedCards&&1<this.dragObj.selectedCards.length&&"Index"===this.parent.sortSettings.sortBy)?".e-card:not(."+pt+"),."+ut:".e-card:not(."+ht+", ."+pt+"),."+ut,t=[].slice.call(this.dragObj.targetClone.parentElement.querySelectorAll(t)).indexOf(this.dragObj.targetClone),this.parent.enableVirtualization)&&!f.isNullOrUndefined(this.dragObj.targetClone.nextElementSibling)&&(i=this.dragObj.targetClone.nextElementSibling.getAttribute("data-id")),!f.isNullOrUndefined(this.kanbanObj)&&this.kanbanObj.element.querySelector("."+ft)&&(r=f.closest(e.target,"."+vt+":not(."+Ke+")")),(s||r)&&(s?n=this.getColumnKey(s):(n=this.getColumnKey(r),s=f.closest(r,"."+u)),this.dragObj.selectedCards instanceof HTMLElement?this.updateDroppedData(this.dragObj.selectedCards,n,s):this.dragObj.selectedCards.forEach(function(e){l.updateDroppedData(e,n,s)}),this.parent.sortSettings.field)&&"Index"===this.parent.sortSettings.sortBy&&this.changeOrder(this.dragObj.modifiedData,e.helper),0===this.dragObj.modifiedData.length&&(this.dragObj.modifiedData=this.dragObj.cardDetails),{cancel:!1,data:this.dragObj.modifiedData,event:e,element:this.dragObj.selectedCards,dropIndex:t});this.parent.trigger(Z,e,function(e){var t,n,a;l.dragStopClear(),e.cancel||(s||r)&&(t=e.data instanceof Array&&1<e.data.length?e.data:e.data[0],a=n=void 0,l.parent.enableVirtualization&&(n=s.closest(".e-kanban").querySelector(".e-dragged-column").getAttribute("data-key"),a=s.getAttribute("data-key")),l.parent.crudModule.updateCard(t,e.dropIndex,!0,i,n,a,o),l.parent.enableVirtualization)&&(l.parent.virtualLayoutModule.refreshColumnData(n,a),l.parent.virtualLayoutModule.ensureColumnNotEmpty(n)),l.removeEmptyTrElement(),l.dragStopPostClear()})},A.prototype.removeEmptyTrElement=function(){if(!this.parent.swimlaneSettings.showEmptyRow)for(var e=this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row"),t=0;t<e.length;t++){var n=e[t].nextElementSibling.querySelectorAll(".e-card-wrapper .e-card");f.isNullOrUndefined(e[t].nextElementSibling)||0!==n.length||(f.detach(e[t].nextElementSibling),f.detach(e[t]))}},A.prototype.dragStopClear=function(){this.removeElement(this.dragObj.draggedClone),this.removeElement(this.dragObj.targetClone,this.kanbanObj),this.removeElement(this.dragObj.cloneElement),[].slice.call(this.parent.element.querySelectorAll("."+ct)).forEach(function(e){f.remove(e)}),this.dragObj.element.style.removeProperty("width"),this.multiCloneRemove(),this.dragObj.selectedCards instanceof HTMLElement?f.removeClass([this.dragObj.selectedCards],ht):f.removeClass(this.dragObj.selectedCards,ht),clearInterval(this.dragObj.navigationInterval),this.dragObj.navigationInterval=null,"not-allowed"===document.body.style.cursor&&(document.body.style.cursor="");[].slice.call(this.parent.element.querySelectorAll(".e-card[style]")).forEach(function(e){e.style.cursor=""});var e="."+m+":not(."+y+")";[].slice.call(this.parent.element.querySelectorAll(e+" ."+u)).forEach(function(e){return f.removeClass([e],E)}),this.parent.externalDropObj&&[].slice.call(this.parent.externalDropObj.element.querySelectorAll(e+" ."+u)).forEach(function(e){return f.removeClass([e],E)})},A.prototype.dragStopPostClear=function(){this.parent.isAdaptive&&(this.parent.touchModule.tabHold=!1),this.parent.element.querySelector(".e-dragged-column")&&this.parent.element.querySelector(".e-dragged-column").classList.remove("e-dragged-column"),this.parent.element.querySelector(".e-dropped-column")&&this.parent.element.querySelector(".e-dropped-column").classList.remove("e-dropped-column"),this.dragObj.cardDetails=this.dragObj.modifiedData=[],this.isDragging=!1,this.parent.isExternalKanbanDrop=!1,this.parent.externalDropObj=null},A.prototype.updateDroppedData=function(e,t,n){e=this.parent.getCardDetails(e),e=f.extend({},e,null,!0);1===t.split(",").length&&(e[this.parent.keyField]=t),this.parent.swimlaneSettings.keyField&&this.parent.swimlaneSettings.allowDragAndDrop&&(t=f.closest(n,"."+m).previousElementSibling,this.parent.isAdaptive?(n=this.parent.layoutModule.kanbanRows[this.parent.layoutModule.swimlaneIndex].keyField,e[this.parent.swimlaneSettings.keyField]=n):e[this.parent.swimlaneSettings.keyField]=this.getColumnKey(t)),this.dragObj.modifiedData.push(e)},A.prototype.changeOrder=function(e,t){var n,a=this,r=!1,t="Ascending"===this.kanbanObj.sortSettings.direction?(t===this.dragObj.targetClone.previousElementSibling&&this.dragObj.targetClone.previousElementSibling&&this.dragObj.targetClone.previousElementSibling.previousElementSibling?this.dragObj.targetClone.previousElementSibling:this.dragObj.targetClone).previousElementSibling:this.dragObj.targetClone.nextElementSibling;if(!t||t.classList.contains(ht)||t.classList.contains(pt)||t.classList.contains(ct))if(this.dragObj.targetClone.nextElementSibling&&"Ascending"===this.kanbanObj.sortSettings.direction)t=this.dragObj.targetClone.nextElementSibling;else{if(!this.dragObj.targetClone.previousElementSibling||"Descending"!==this.kanbanObj.sortSettings.direction)return;t=this.dragObj.targetClone.previousElementSibling}else r=!0;t.classList.contains(S)&&(n=this.kanbanObj.getCardDetails(t)[this.kanbanObj.sortSettings.field],(e=1<e.length&&"Descending"===this.kanbanObj.sortSettings.direction?e.reverse():e).forEach(function(e,t){r?e[a.kanbanObj.sortSettings.field]=++n:1!==n&&t<=e[a.kanbanObj.sortSettings.field]?e[a.kanbanObj.sortSettings.field]=--n:1===n&&(e[a.kanbanObj.sortSettings.field]=t+1)}))},A.prototype.toggleVisible=function(t,n){var a=this,e=([].slice.call(this.kanbanObj.element.querySelectorAll(".e-header-cells:not(.e-stacked-header-cell)")).forEach(function(e){a.getColumnKey(e)===a.getColumnKey(n||t)&&a.kanbanObj.actionModule.columnToggle(e)}),f.closest(this.dragObj.draggedClone,"."+u));e&&(e=f.formatUnit(e.offsetWidth-16),this.dragObj.draggedClone.style.width=e,this.dragObj.cloneElement.style.width=e)},A.prototype.multiCloneRemove=function(){var e=f.isNullOrUndefined(this.kanbanObj)?[]:[].slice.call(this.kanbanObj.element.querySelectorAll("."+ft));0<e.length&&([].slice.call(this.kanbanObj.element.querySelectorAll("."+vt)).forEach(function(e){return f.remove(e)}),e.forEach(function(e){e=f.closest(e,"."+u);e&&(e.style.borderStyle="",e.querySelector("."+x)&&f.removeClass([e.querySelector("."+x)],yt),f.removeClass([e.querySelector("."+b)],yt))}),this.removeElement(this.dragObj.targetCloneMulti,this.kanbanObj))},A.prototype.calculateArgs=function(e){e=this.getPageCoordinates(e);this.dragObj.pageY=e.pageY,this.dragObj.pageX=e.pageX,this.isDragging=!0,this.kanbanObj.isAdaptive&&this.kanbanObj.tooltipModule&&this.kanbanObj.tooltipModule.tooltipObj.close()},A.prototype.getPageCoordinates=function(e){var t=e.event;return t&&t.changedTouches?t.changedTouches[0]:e.changedTouches?e.changedTouches[0]:t||e},A.prototype.getColumnKey=function(e){return e&&e.getAttribute("data-key")?e.getAttribute("data-key").trim():""},A.prototype.updateScrollPosition=function(){var e=this;f.isNullOrUndefined(this.dragObj.navigationInterval)&&(this.dragObj.navigationInterval=window.setInterval(function(){e.autoScroll()},100))},A.prototype.autoScrollValidation=function(){var e=this.dragObj.pageY,t=this.dragObj.pageX,n={left:!1,right:!1,top:!1,bottom:!1},a=this.kanbanObj.element.querySelector("."+g).getBoundingClientRect();e<a.top+30+window.pageYOffset&&e>a.top+window.pageYOffset&&(n.top=!0),e>a.bottom-30+window.pageYOffset&&e<a.bottom+window.pageYOffset&&(n.bottom=!0),t<a.left+30+window.pageXOffset&&t>a.left+window.pageXOffset&&(n.left=!0),t>a.right-30+window.pageXOffset&&t<a.right+window.pageXOffset&&(n.right=!0),this.dragEdges=n},A.prototype.autoScroll=function(){this.autoScrollValidation();var e,t,n,a,r;this.kanbanObj.isAdaptive?(this.dragEdges.top||this.dragEdges.bottom?a=this.dragObj.targetClone?f.closest(this.dragObj.targetClone,"."+b):f.closest(this.dragObj.draggedClone,"."+b):(this.dragEdges.right||this.dragEdges.left)&&(a=this.kanbanObj.element.querySelector("."+g)),a&&(e=a.offsetHeight<=a.scrollHeight,r=a.offsetWidth<=a.scrollWidth,t=0<=a.scrollTop&&a.scrollTop+a.offsetHeight<=a.scrollHeight,n=0<=a.scrollLeft&&a.scrollLeft+a.offsetWidth<=a.scrollWidth,e&&t&&(this.dragEdges.top||this.dragEdges.bottom)&&(a.scrollTop+=this.dragEdges.top?-66:30),r)&&n&&(this.dragEdges.left||this.dragEdges.right)&&((this.parent.enableVirtualization?this.kanbanObj.virtualLayoutModule:this.kanbanObj.layoutModule).getWidth()*(this.kanbanObj.columns.length-1)>a.scrollLeft||this.dragEdges.left)&&(a.scrollLeft+=this.dragEdges.left?-30:30)):(e=this.kanbanObj.element.querySelector("."+g),t=this.dragObj.targetClone.parentElement,r=e.offsetHeight<=e.scrollHeight,n=e.offsetWidth<=e.scrollWidth,a=r&&0<=e.scrollTop&&e.scrollTop+e.offsetHeight<=e.scrollHeight,r=n&&0<=e.scrollLeft&&e.scrollLeft+e.offsetWidth<=e.scrollWidth,a&&(this.dragEdges.top||this.dragEdges.bottom)&&(e.scrollTop+=this.dragEdges.top?-30:30,this.parent.swimlaneSettings.enableFrozenRows&&(this.dragObj.cloneElement.style.top=this.dragEdges.top?parseInt(this.dragObj.cloneElement.style.top,10)-30+"px":parseInt(this.dragObj.cloneElement.style.top,10)+30+"px"),t)&&(t.scrollTop+=this.dragEdges.top?-30:30),r&&(this.dragEdges.left||this.dragEdges.right)&&(e.scrollLeft+=this.dragEdges.left?-30:30,t)&&(t.scrollLeft+=this.dragEdges.left?-30:30),this.dragObj.pageY-window.scrollY<30?window.scrollTo(window.scrollX,window.scrollY-30):window.innerHeight-(this.dragObj.pageY-window.scrollY)<30&&window.scrollTo(window.scrollX,window.scrollY+30))},A.prototype.unWireDragEvents=function(e){f.isNullOrUndefined(e)||f.isNullOrUndefined(e.ej2_instances[0])||(e=e.ej2_instances[0])&&!e.isDestroyed&&e.destroy()};var It=A;function A(e){this.insertClone="afterend",this.parent=e,this.dragObj={element:null,cloneElement:null,instance:null,targetClone:null,draggedClone:null,targetCloneMulti:null,selectedCards:[],pageX:0,pageY:0,navigationInterval:null,cardDetails:[],modifiedData:[]},this.dragEdges={left:!1,right:!1,top:!1,bottom:!1},this.isDragging=!1,this.isExternalDrop=!1}F.prototype.openDialog=function(e,t){this.action=e,this.parent.activeCardData.data=t,this.renderDialog(t,e),this.dialogObj.show()},F.prototype.closeDialog=function(){this.dialogObj.hide()},F.prototype.renderDialog=function(e,t){this.element=f.createElement("div",{id:this.parent.element.id+"_dialog_wrapper"}),this.parent.element.appendChild(this.element);e={buttons:this.getDialogButtons(t),content:this.getDialogContent(e,t),cssClass:ot,enableRtl:this.parent.enableRtl,header:this.parent.localeObj.getConstant("Add"===t?"addTitle":"Edit"===t?"editTitle":"deleteTitle"),height:"auto",isModal:!0,showCloseIcon:!0,width:"Delete"===t?400:350,visible:!1,beforeOpen:this.onBeforeDialogOpen.bind(this),beforeClose:this.onBeforeDialogClose.bind(this)};this.dialogObj=new P.Dialog(f.extend(e,"Delete"!==t&&this.parent.dialogSettings.model||{}),this.element),"Delete"!==t&&this.applyFormValidation(),this.dialogObj.element.querySelector(".e-dlg-closeicon-btn").title=this.parent.localeObj.getConstant("close")},F.prototype.getDialogContent=function(e,t){if("Delete"===t)return this.parent.localeObj.getConstant("deleteContent");var t=f.createElement("div",{className:"e-kanban-form-wrapper"}),n=f.createElement("form",{id:this.parent.element.id+"EditForm",className:lt,attrs:{onsubmit:"return false;"}});if(this.parent.dialogSettings.template){e&&(this.destroyComponents(),[].slice.call(n.childNodes).forEach(function(e){return f.remove(e)}));var a=this.parent.element.id+"_dialogTemplate",e=this.parent.templateParser(this.parent.dialogSettings.template)(e,this.parent,"dialogTemplate",a,!1);f.append(e,n),this.parent.renderTemplates()}else{var a=f.createElement("div",{className:"e-kanban-dialog-content"}),r=(n.appendChild(a),f.createElement("table"));a.appendChild(r);for(var i=0,o=this.getDialogFields();i<o.length;i++){var l=o[i],s=f.createElement("tr"),d=(r.appendChild(s),s.appendChild(f.createElement("td",{className:"e-label",innerHTML:l.text||l.key})),f.createElement("td"));s.appendChild(d),d.appendChild(this.renderComponents(l))}}return t.appendChild(n),t},F.prototype.getDialogFields=function(){var e=this.parent.dialogSettings.fields;return 0===e.length&&(e=[{text:"ID",key:this.parent.cardSettings.headerField,type:"TextBox"},{key:this.parent.keyField,type:"DropDown"},{key:this.parent.cardSettings.contentField,type:"TextArea"}],this.parent.sortSettings.field&&e.splice(e.length-1,0,{key:this.parent.sortSettings.field,type:"TextBox"}),this.parent.swimlaneSettings.keyField)&&e.splice(e.length-1,0,{key:this.parent.swimlaneSettings.keyField,type:"DropDown"}),e},F.prototype.getDialogButtons=function(e){var t="Delete"===e?"e-dialog-no":"e-dialog-cancel",t=[{buttonModel:{cssClass:"e-flat "+("Delete"===e?"e-dialog-yes":"Add"===e?"e-dialog-add":"e-dialog-edit"),isPrimary:!0,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"save":"yes")},click:this.dialogButtonClick.bind(this)},{buttonModel:{cssClass:"e-flat "+t,isPrimary:!1,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"cancel":"no")},click:this.dialogButtonClick.bind(this)}];return"Edit"===e&&(e={buttonModel:{cssClass:"e-flat e-dialog-delete",isPrimary:!1,content:this.parent.localeObj.getConstant("delete")},click:this.dialogButtonClick.bind(this)},t.splice(0,0,e)),t},F.prototype.renderComponents=function(e){var t,n,a=f.createElement("div",{className:e.key+"_wrapper"}),r=f.createElement("input",{className:dt,attrs:{name:e.key}}),i=(a.appendChild(r),this.parent.activeCardData.data?this.parent.activeCardData.data[e.key]:null);switch(e.type){case"DropDown":if(e.key===this.parent.keyField){var o=(this.parent.enableVirtualization?this.parent.virtualLayoutModule:this.parent.layoutModule).columnKeys;if(0<this.parent.actionModule.hideColumnKeys.length){o=[];for(var l=0;l<this.parent.columns.length;l++)(this.parent.enableVirtualization?this.parent.virtualLayoutModule:this.parent.layoutModule).isColumnVisible(this.parent.columns[l])&&(o="number"==typeof this.parent.columns[l].keyField?o.concat(this.parent.columns[l].keyField.toString()):o.concat(this.parent.columns[l].keyField.split(",").map(function(e){return e.trim()})))}t={dataSource:o,value:i&&i.toString()}}else e.key===this.parent.swimlaneSettings.keyField&&(t={dataSource:[].slice.call((this.parent.enableVirtualization?this.parent.virtualLayoutModule:this.parent.layoutModule).kanbanRows),fields:{text:"textField",value:"keyField"},value:i});n=new N.DropDownList(t);break;case"Numeric":n=new H.NumericTextBox({value:i});break;case"TextBox":n=new H.TextBox({value:i}),i&&this.parent.cardSettings.headerField===e.key&&(n.enabled=!1);break;case"TextArea":f.remove(r),t=f.createElement("div"),r=f.createElement("textarea",{className:dt,attrs:{name:e.key,rows:"3","aria-label":this.parent.cardSettings.contentField},innerHTML:i}),a.appendChild(t).appendChild(r)}return n&&n.appendTo(r),a},F.prototype.onBeforeDialogOpen=function(t){var n=this,e={data:this.parent.activeCardData.data,cancel:!1,element:this.element,target:this.parent.activeCardData.element,requestType:this.action};this.storeElement=document.activeElement,parseInt(t.maxHeight,10)<=250&&(t.maxHeight="250px"),this.parent.trigger($,e,function(e){t.cancel=e.cancel,e.cancel&&n.destroy()})},F.prototype.onBeforeDialogClose=function(t){var n=this,e=this.getFormElements(),a={};if(t.isInteracted&&(this.preventUpdate=!0),!this.preventUpdate)for(var r=0,i=e;r<i.length;r++){var o=i[r],l=o.name||this.getColumnName(o);f.isNullOrUndefined(l)||""===l||(o=this.getValueFromElement(o),l===this.parent.cardSettings.headerField&&(o="string"===this.getIDType()?o:parseInt(o,10)),a[l]=o)}this.preventUpdate=!1;var s={data:a=f.extend(this.parent.activeCardData.data,a),cancel:!1,element:this.element,requestType:this.action};this.parent.trigger(ee,s,function(e){t.cancel=e.cancel,e.cancel||(n.cardData=s.data,n.destroy(),n.parent.actionModule.SingleCardSelection(n.cardData))})},F.prototype.getIDType=function(){return 0!==this.parent.kanbanData.length?typeof this.parent.kanbanData[0][this.parent.cardSettings.headerField]:"string"},F.prototype.applyFormValidation=function(){for(var a=this,e=this.element.querySelector("."+lt),t={},n=0,r=this.parent.dialogSettings.fields;n<r.length;n++){var i=r[n];t[i.key]=i.validationRules&&0<Object.keys(i.validationRules).length?i.validationRules:null}this.formObj=new H.FormValidator(e,{rules:t,customPlacement:function(e,t){var n=t.getAttribute("for");a.element.querySelector("#"+n+"_Error")||a.createTooltip(e,t,n,"")},validationComplete:function(e){var t=a.element.querySelector("#"+e.inputName+"_Error");t&&(t.style.display="failure"===e.status?"":"none")}})},F.prototype.createTooltip=function(e,t,n,a){var r,e=e.parentElement.getBoundingClientRect(),i=(this.element.classList.contains(ot)?(r=this.element,this.element):r=this.element.querySelector(".e-kanban-dialog .e-dlg-content")).getBoundingClientRect(),n=f.createElement("div",{className:"e-tooltip-wrap e-popup "+st,id:n+"_Error",styles:"display:"+a+";top:"+(e.bottom-i.top+r.scrollTop+9)+"px;left:"+(e.left-i.left+r.scrollLeft+e.width/2)+"px;"}),a=f.createElement("div",{className:"e-tip-content"}),i=(a.appendChild(t),f.createElement("div",{className:"e-arrow-tip e-tip-top"}));i.appendChild(f.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),i.appendChild(f.createElement("div",{className:"e-arrow-tip-inner e-tip-top"})),n.appendChild(a),n.appendChild(i),r.appendChild(n),n.style.left=parseInt(n.style.left,10)-n.offsetWidth/2+"px"},F.prototype.destroyToolTip=function(){this.element&&this.element.querySelectorAll("."+st).forEach(function(e){return f.remove(e)}),this.formObj&&this.formObj.element&&this.formObj.reset()},F.prototype.dialogButtonClick=function(e){var t,n=e.target.cloneNode(!0),e=(f.isNullOrUndefined(e.keyCode)||13!==e.keyCode||(n=this.dialogObj.element.querySelector(".e-footer-content button.e-primary").cloneNode(!0)),this.formObj.element.id);document.getElementById(e)&&this.formObj.validate()&&(n.classList.contains("e-dialog-edit")||n.classList.contains("e-dialog-add"))&&(this.dialogObj.hide(),f.isNullOrUndefined(this.cardData)||(n.classList.contains("e-dialog-edit")&&(e=void 0,(t=this.parent.activeCardData).data[this.parent.keyField]===this.cardData[this.parent.keyField]&&t.element&&(e=[].slice.call(t.element.parentElement.children).indexOf(t.element)),this.parent.enableHtmlSanitizer&&"string"==typeof this.cardData[this.parent.cardSettings.contentField]&&(this.cardData[this.parent.cardSettings.contentField]=f.SanitizeHtmlHelper.sanitize(this.cardData[this.parent.cardSettings.contentField])),this.parent.crudModule.updateCard(this.cardData,e)),n.classList.contains("e-dialog-add")&&this.parent.crudModule.addCard(this.cardData),this.parent.actionModule.SingleCardSelection(this.cardData),this.cardData=null)),n.classList.contains("e-dialog-edit")||n.classList.contains("e-dialog-add")||(n.classList.contains("e-dialog-cancel")&&(this.preventUpdate=!0),this.dialogObj.hide(),n.classList.contains("e-dialog-yes")?this.parent.crudModule.deleteCard(this.parent.activeCardData.data):n.classList.contains("e-dialog-no")?this.openDialog("Edit",this.parent.activeCardData.data):n.classList.contains("e-dialog-delete")&&this.openDialog("Delete",this.parent.activeCardData.data))},F.prototype.getFormElements=function(){for(var e=[],t=0,n=[].slice.call(this.element.querySelectorAll("."+dt));t<n.length;t++){var a=n[t];!a.classList.contains("e-control")&&a.querySelector(".e-control")?e.push(a.querySelector(".e-control")):e.push(a)}return e},F.prototype.getColumnName=function(e){var t,n,a=e.getAttribute("data-name")||"";return a=""===a&&(n=!1,t="",e.classList.contains("e-dropdownlist")||e.classList.contains("e-multiselect")?(t=e.classList.contains("e-dropdownlist")?"e-ddl":"e-multiselect",n=!0):e.classList.contains("e-numerictextbox")&&(t="e-numeric"),n=f.closest(e,n?"."+t+":not(.e-control)":"."+t)||e.querySelector("."+t))&&(e=n.querySelector("[name]"))?e.name:a},F.prototype.getValueFromElement=function(e){e=e.classList.contains("e-dropdownlist")||e.classList.contains("e-multiselect")?e.ej2_instances[0].value:e.classList.contains("e-checkbox")?e.ej2_instances[0].checked:"checkbox"===e.type?e.checked:e.value;return e},F.prototype.destroyComponents=function(){for(var e=0,t=this.getFormElements();e<t.length;e++){var n=t[e].ej2_instances;n&&0<n.length&&n.forEach(function(e){return e.destroy()}),this.parent.isReact&&this.formObj&&this.formObj.element.remove()}},F.prototype.destroy=function(){this.destroyToolTip(),this.destroyComponents(),this.dialogObj&&(this.dialogObj.destroy(),this.storeElement.focus(),this.dialogObj=null,f.remove(this.element),this.element=null)};var Bt=F;function F(e){this.preventUpdate=!1,this.parent=e}M.prototype.keyActionHandler=function(e){var t=this,n=this.parent.element.querySelectorAll(".e-card."+k).item(0);if(n||f.closest(document.activeElement,"."+Ee)){var a,r,i=[];switch(e.action){case"upArrow":case"downArrow":case"multiSelectionByUpArrow":case"multiSelectionByDownArrow":e.preventDefault(),this.processUpDownArrow(e.action,n);break;case"rightArrow":case"leftArrow":this.processLeftRightArrow(e);break;case"firstCardSelection":case"lastCardSelection":this.processCardSelection(e.action,n);break;case"multiSelectionEnter":case"multiSelectionSpace":document.activeElement&&this.parent.actionModule.cardSelection(document.activeElement,!0,!1);break;case"space":case"enter":this.processEnter(e,n);break;case"escape":(document.activeElement.classList.contains(S)||document.activeElement.classList.contains(x))&&(document.activeElement.classList.contains(k)?(f.removeClass([document.activeElement],k),document.activeElement.focus()):(a=f.closest(document.activeElement,"."+u),r=[].slice.call(a.querySelectorAll("."+S)),f.removeClass(r,k),a.focus(),this.cardTabIndexRemove(),this.addRemoveTabIndex("Add")));break;case"tab":case"shiftTab":r=f.closest(document.activeElement,"."+u),document.activeElement.classList.contains(S)&&(document.activeElement.nextElementSibling||"tab"!==e.action||e.preventDefault(),!document.activeElement.previousElementSibling)&&r.querySelector("."+x)&&"tab"===e.action&&f.addClass([r.querySelector("."+x)],qt),!document.activeElement.classList.contains(x)||(r.querySelector("."+S)||"tab"!==e.action)&&"shiftTab"!==e.action||e.preventDefault(),document.activeElement.classList.contains(Ee)&&(this.cardTabIndexRemove(),this.parent.keyboardModule.addRemoveTabIndex("Add"));break;case"delete":[].slice.call(this.parent.element.querySelectorAll(".e-card."+k)).forEach(function(e){i.push(t.parent.getCardDetails(e))}),this.parent.crudModule.deleteCard(i)}}},M.prototype.processCardSelection=function(e,t){t&&(f.removeClass([t],k),(this.parent.enableVirtualization?this.parent.virtualLayoutModule:this.parent.layoutModule).disableAttributeSelection(t),(n=this.parent.actionModule.selectionArray).splice(n.indexOf(t.getAttribute("data-id")),1)),this.cardTabIndexRemove();var n=[].slice.call(this.parent.element.querySelectorAll("."+S)),t="firstCardSelection"===e?n[0]:n[n.length-1];this.parent.actionModule.cardSelection(t,!1,!1),this.addRemoveTabIndex("Remove"),t.focus(),[].slice.call(f.closest(t,"."+u).querySelectorAll("."+S)).forEach(function(e){e.setAttribute("tabindex","0")})},M.prototype.processLeftRightArrow=function(e){document.activeElement.classList.contains(u)&&("rightArrow"===e.action&&document.activeElement.nextElementSibling?document.activeElement.nextElementSibling.focus():"leftArrow"===e.action&&document.activeElement.previousElementSibling&&document.activeElement.previousElementSibling.focus())},M.prototype.processUpDownArrow=function(e,t){var n;"upArrow"===e&&document.activeElement?(document.activeElement.classList.contains(S)&&document.activeElement.previousElementSibling?document.activeElement.previousElementSibling.focus():document.activeElement.classList.contains(x)&&(document.activeElement.setAttribute("tabindex","-1"),f.removeClass([document.activeElement],qt),0<(n=f.closest(document.activeElement,"."+u)).querySelectorAll("."+S).length)&&[].slice.call(n.querySelectorAll("."+S)).slice(-1)[0].focus(),this.removeSelection()):"downArrow"===e&&document.activeElement&&document.activeElement.classList.contains(S)&&(document.activeElement.nextElementSibling?document.activeElement.nextElementSibling.focus():f.closest(document.activeElement,"."+b).nextElementSibling&&((n=f.closest(document.activeElement,"."+b).nextElementSibling).setAttribute("tabindex","0"),f.addClass([n],qt),n.focus()),this.removeSelection()),("multiSelectionByUpArrow"===e||"multiSelectionByDownArrow"===e)&&t&&"Multiple"===this.parent.cardSettings.selectionType&&(n=void 0,n="multiSelectionByUpArrow"===e?document.activeElement.previousElementSibling:document.activeElement.nextElementSibling)&&(this.parent.actionModule.cardSelection(n,!1,!0),n.focus(),this.multiSelection=!0)},M.prototype.removeSelection=function(){var e;this.multiSelection&&(0<(e=this.parent.getSelectedCards()).length&&(f.removeClass(e,k),(this.parent.enableVirtualization?this.parent.virtualLayoutModule:this.parent.layoutModule).disableAttributeSelection(e)),this.multiSelection=!1)},M.prototype.cardTabIndexRemove=function(){[].slice.call(this.parent.element.querySelectorAll("."+S)).forEach(function(e){e.setAttribute("tabindex","-1")}),[].slice.call(this.parent.element.querySelectorAll("."+x)).forEach(function(e){e.setAttribute("tabindex","-1"),f.removeClass([e],qt)})},M.prototype.processEnter=function(e,t){"space"===e.action&&e.preventDefault();var n=e.target;n.classList.contains(Re)&&this.parent.actionModule.columnExpandCollapse(e),(n.classList.contains(Be)||n.classList.contains(v))&&this.parent.actionModule.rowExpandCollapse(e),document.activeElement.classList.contains(S)&&this.parent.actionModule.cardSelection(document.activeElement,!1,!1),document.activeElement.classList.contains(x)&&(this.parent.dialogModule.dialogObj||this.parent.actionModule.addButtonClick(document.activeElement),document.activeElement.focus()),n.classList.contains(u)&&(e=[].slice.call(n.querySelectorAll("."+S)),this.addRemoveTabIndex("Remove"),0<e.length&&(n.querySelector("."+S).focus(),e.forEach(function(e){e.setAttribute("tabindex","0")})),n.querySelector("."+x))&&(n.querySelector("."+x).setAttribute("tabindex","0"),n.querySelector("."+x).focus()),t===document.activeElement&&1===this.parent.element.querySelectorAll("."+k).length&&(this.parent.activeCardData={data:this.parent.getCardDetails(t),element:t},this.parent.dialogModule.dialogObj||this.parent.dialogModule.openDialog("Edit",this.parent.getCardDetails(t)),t.focus())},M.prototype.addRemoveTabIndex=function(e){var t="Add"===e?"0":"-1",e=[].slice.call(this.parent.element.querySelectorAll("."+Re)),e=(0<e.length&&e.forEach(function(e){e.setAttribute("tabindex",t)}),[].slice.call(this.parent.element.querySelectorAll("."+Be)));0<e.length&&e.forEach(function(e){e.setAttribute("tabindex",t)});[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row) .e-content-cells")).forEach(function(e){e.setAttribute("tabindex",t)})},M.prototype.destroy=function(){this.keyboardModule.destroy()};var Ut=M;function M(e){this.keyConfigs={firstCardSelection:"36",lastCardSelection:"35",upArrow:"38",downArrow:"40",rightArrow:"39",leftArrow:"37",multiSelectionEnter:"ctrl+13",multiSelectionSpace:"ctrl+32",multiSelectionByUpArrow:"shift+38",multiSelectionByDownArrow:"shift+40",shiftTab:"shift+tab",enter:"13",tab:"tab",delete:"46",escape:"27",space:"32"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new f.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.multiSelection=!1}Vt.prototype.renderTooltip=function(){this.tooltipObj=new P.Tooltip({cssClass:this.parent.cssClass+" e-kanban-tooltip",enableRtl:this.parent.enableRtl,mouseTrail:!this.parent.isAdaptive,offsetY:5,position:"BottomCenter",showTipPointer:!0,target:"."+bt,beforeRender:this.onBeforeRender.bind(this),beforeClose:this.onBeforeClose.bind(this)}),this.tooltipObj.appendTo(this.parent.element),this.tooltipObj.isStringTemplate=!0},Vt.prototype.onBeforeRender=function(e){var t,n,a;this.parent.dragAndDropModule.isDragging?e.cancel=!0:(this.parent.tooltipTemplate?(t=f.createElement("div"),a=f.closest(e.target,"."+S),a=this.parent.getCardDetails(a),n=this.parent.element.id+"_tooltipTemplate",a=this.parent.templateParser(this.parent.tooltipTemplate)(a,this.parent,"tooltipTemplate",n,!1),f.append(a,t),this.parent.renderTemplates()):t=f.initializeCSPTemplate(function(){return'<div class="e-card-header-caption">'+e.target.innerText+"</div>"}),this.tooltipObj.setProperties({content:t},!0))},Vt.prototype.onBeforeClose=function(){this.parent.resetTemplates(["tooltipTemplate"])},Vt.prototype.destroy=function(){this.tooltipObj.destroy(),f.addClass([this.parent.element],"e-control"),this.tooltipObj=null};var zt=Vt;function Vt(e){this.parent=e,this.renderTooltip()}T.prototype.wireTouchEvents=function(){this.element=this.parent.element.querySelector("."+g),this.touchObj=new f.Touch(this.element,{tapHold:this.tapHoldHandler.bind(this)})},T.prototype.tapHoldHandler=function(e){this.tabHold=!0;e=f.closest(e.originalEvent.target,"."+S);e&&"Multiple"===this.parent.cardSettings.selectionType&&(this.parent.actionModule.cardSelection(e,!0,!1),this.mobilePopup||(this.renderMobilePopup(),this.mobilePopup.show()),this.updatePopupContent())},T.prototype.renderMobilePopup=function(){var e,t;"Multiple"===this.parent.cardSettings.selectionType&&(e=f.createElement("div",{className:"e-mobile-popup-wrapper e-popup-close",innerHTML:'<div class="e-popup-header"><button class="'+Mt+'"></button></div><div class="'+Tt+'"></div>'}),document.body.appendChild(e),f.addClass([e],Oe),this.mobilePopup=new P.Popup(e,{targetType:"container",enableRtl:this.parent.enableRtl,hideAnimation:{name:"ZoomOut"},showAnimation:{name:"ZoomIn"},collision:{X:"fit",Y:"fit"},position:{X:"left",Y:"top"},viewPortElement:document.body,zIndex:1004,close:this.popupClose.bind(this)}),e=this.mobilePopup.element.querySelector("."+Mt),(t=new I.Button({cssClass:"e-flat e-round e-small",enableRtl:this.parent.enableRtl,iconCss:xe+" e-close-icon"})).appendTo(e),t.isStringTemplate=!0,f.EventHandler.add(e,"click",this.closeClick,this))},T.prototype.getPopupContent=function(){var e,t=this.parent.getSelectedCards();return 1<t.length?e="("+t.length+") "+this.parent.localeObj.getConstant("cardsSelected"):1===t.length&&(e=" "+this.parent.getCardDetails(t[0])[this.parent.cardSettings.headerField]),e},T.prototype.updatePopupContent=function(){var e;this.mobilePopup&&((e=this.getPopupContent())?this.mobilePopup.element.querySelector("."+Tt).textContent=e:this.mobilePopup.hide())},T.prototype.closeClick=function(){this.parent.touchModule.mobilePopup.hide()},T.prototype.popupClose=function(){this.popupDestroy()},T.prototype.popupDestroy=function(){var e;this.mobilePopup&&this.mobilePopup.element&&((e=this.mobilePopup.element.querySelector(".e-control.e-btn").ej2_instances[0])&&e.destroy(),this.mobilePopup.destroy(),f.remove(this.mobilePopup.element),this.mobilePopup=null)},T.prototype.unWireTouchEvents=function(){this.touchObj&&this.touchObj.destroy(),this.touchObj=null,this.element=null},T.prototype.destroy=function(){this.popupDestroy(),this.unWireTouchEvents(),this.tabHold=!1};var _t=T;function T(e){this.parent=e,this.tabHold=!1}Kt.prototype.renderSwimlaneHeader=function(){var e=f.createElement("div",{className:O,innerHTML:'<div class="e-swimlane-header-toolbar"><div class="e-toolbar-menu"><div class="e-icons '+St+'"></div></div><div class="e-toolbar-level-title"><div class="'+Ct+'"></div></div></div>'});this.parent.element.appendChild(e),f.EventHandler.add(e.querySelector("."+St),"click",this.menuClick,this)},Kt.prototype.renderSwimlaneTree=function(){var e=this.parent.element.querySelector("."+O).offsetHeight,t=window.innerHeight-e,e=(this.popupOverlay=f.createElement("div",{className:wt,styles:"height: "+t+"px;"}),f.createElement("div",{className:Et,styles:"top:"+e+"px;"})),t=f.createElement("div",{className:kt+" e-popup-close",styles:"height: "+t+"px;"}),e=(e.appendChild(t),e.appendChild(this.popupOverlay),this.parent.element.appendChild(e),f.createElement("div",{className:"e-swimlane-tree"})),n=(t.appendChild(e),(this.parent.enableVirtualization?this.parent.virtualLayoutModule:this.parent.layoutModule).kanbanRows),n=(this.treeViewObj=new B.TreeView({cssClass:this.parent.cssClass,enableRtl:this.parent.enableRtl,fields:{dataSource:n,id:"keyField",text:"textField"},nodeTemplate:this.parent.swimlaneSettings.template,nodeClicked:this.treeSwimlaneClick.bind(this),drawNode:this.drawNode.bind(this)}),this.treeViewObj.appendTo(e),{targetType:"relative",actionOnScroll:"none",enableRtl:this.parent.enableRtl,zIndex:10,hideAnimation:{name:"SlideLeftOut",duration:500},showAnimation:{name:"SlideLeftIn",duration:500},viewPortElement:this.parent.element.querySelector("."+g)});n.content=this.treeViewObj.element,this.treePopup=new P.Popup(t,n)},Kt.prototype.menuClick=function(){var e;this.parent.element.querySelector("."+kt).classList.contains("e-popup-open")?(this.treePopup.hide(),f.removeClass([this.popupOverlay],"e-enable")):(e=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item")),f.removeClass(e,"e-active"),f.addClass([e[this.parent.layoutModule.swimlaneIndex]],"e-active"),this.treePopup.show(),f.addClass([this.popupOverlay],"e-enable"))},Kt.prototype.treeSwimlaneClick=function(e){this.treePopup.hide();var t=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));this.parent.layoutModule.swimlaneIndex=t.indexOf(e.node),this.parent.layoutModule.scrollLeft=0,this.parent.notify(i,{processedData:this.parent.kanbanData}),e.event.preventDefault()},Kt.prototype.hidePopup=function(){this.treePopup.hide(),f.removeClass([this.popupOverlay],"e-enable")},Kt.prototype.getWidth=function(){return 80*window.innerWidth/100},Kt.prototype.drawNode=function(e){var t;this.parent.swimlaneSettings.template&&this.parent.isReact&&(t=this.parent.element.id+"_treeviewTemplate",t=this.parent.templateParser(this.parent.swimlaneSettings.template)(e.nodeData,this.parent,"nodeTemplate",t,!1),f.append(t,e.node.querySelector(".e-list-text")))};Ce=Kt;function Kt(e){this.parent=e}Wt=function(e,t){return(Wt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};(function(e,t){function n(){this.constructor=e}Wt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)})(j,Yt=Ce),j.prototype.initRender=function(){var e;0!==this.parent.columns.length&&(this.columnData=this.getColumnCards(),this.kanbanRows=this.getRows(),this.swimlaneData=this.getSwimlaneCards(),this.parent.isAdaptive&&(e=this.parent.element.querySelector("."+g))&&(this.scrollLeft=e.scrollLeft),this.destroy(),this.parent.on(i,this.initRender,this),this.parent.on(h,this.scrollUiUpdate,this),this.parent.isAdaptive&&this.parent.swimlaneSettings.keyField&&0!==this.parent.kanbanData.length&&this.renderSwimlaneHeader(),e=f.createElement("div",{className:c}),this.parent.element.appendChild(e),this.renderHeader(e),this.renderContent(),this.renderCards(),this.renderValidation(),this.parent.renderTemplates(),this.parent.notify(h,{}),this.wireEvents(),this.parent.isInitialRender)&&(this.parent.isInitialRender=!1)},j.prototype.renderHeader=function(e){for(var t=f.createElement("div",{className:this.parent.swimlaneSettings.keyField?Ae:""}),e=(e.appendChild(t),f.createElement("table",{className:Fe+" "+Me})),t=(t.appendChild(e),this.renderColGroup(e),f.createElement("thead")),n=f.createElement("tbody",{className:"e-hide",innerHTML:"<tr><td></td></tr>",attrs:{role:"rowgroup"}}),s=(e.appendChild(n),e.appendChild(t),0<this.parent.stackedHeaders.length&&t.appendChild(this.createStackedRow(this.parent.stackedHeaders)),f.createElement("tr",{className:Ie})),d=(t.appendChild(s),this),a=0,r=this.parent.columns;a<r.length;a++)!function(e){var t,n,a,r,i,o,l;d.isColumnVisible(e)&&(t=d.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),n=f.createElement("th",{className:-1===t?p:p+" "+w,attrs:{"data-role":"kanban-column","data-key":e.keyField.toString(),scope:"col"}}),a=[],e.allowToggle&&(a.push(He),e.isExpanded||a.push(w)),f.addClass([n],a),a=f.createElement("div",{className:Te}),n.appendChild(a),d.columnData=d.getColumnCards(d.parent.kanbanData),r=d.columnData[e.keyField].length,o=f.createElement("div",{className:je}),a.appendChild(o),e.template?(l={keyField:e.keyField,headerText:e.headerText,minCount:e.minCount,maxCount:e.maxCount,allowToggle:e.allowToggle,isExpanded:e.isExpanded,showItemCount:e.showItemCount,count:r},f.addClass([n],De),i=d.parent.element.id+"_columnTemplate",l=d.parent.templateParser(e.template)(l,d.parent,"columnTemplate",i,!1),f.append(l,o)):(i=f.createElement("div",{className:qe,innerHTML:e.headerText}),o.appendChild(i),e.showItemCount&&(l=f.createElement("div",{className:Ue,innerHTML:"- "+r.toString()+" "+d.parent.localeObj.getConstant("items")}),o.appendChild(l))),e.allowToggle&&(i=!(!e.isExpanded||-1!==t),(o=f.createElement("div",{className:Re+" "+xe+" "+(i?at:rt),attrs:{tabindex:"0",role:"button"}})).setAttribute("aria-label",i?e.keyField+" Expand":e.keyField+" Collapse"),n.setAttribute("aria-expanded",i.toString()),a.appendChild(o)),l=[{keyField:e.keyField,textField:e.headerText,count:r}],d.parent.trigger(Y,{data:l,element:s,cancel:!1,requestType:"headerRow"},function(e){e.cancel||s.appendChild(n)}))}(r[a])},j.prototype.renderContent=function(){for(var e=f.createElement("div",{className:g}),t=(this.parent.element.appendChild(e),f.createElement("div",{className:this.parent.swimlaneSettings.keyField?Ae:""})),e=(e.appendChild(t),f.createElement("table",{className:Fe+" "+Ne,attrs:{role:"presentation"}})),n=(t.appendChild(e),this.renderColGroup(e),f.createElement("thead",{className:"e-hide",attrs:{role:"none"}})),a=0,r=this.parent.columns;a<r.length;a++){var i=r[a],i=f.createElement("th",{id:i.keyField,innerHTML:i.keyField,attrs:{scope:"col"}});i.style.display="none",n.appendChild(i)}e.appendChild(n);var o=f.createElement("tbody",{attrs:{role:"treegrid","aria-label":"Kanban Content"}}),l=(e.appendChild(o),!1);this.swimlaneRow=this.kanbanRows,this.initializeSwimlaneTree();for(var s=0,d=this.swimlaneRow;s<d.length;s++){var c=d[s];this.parent.swimlaneSettings.keyField&&0!==this.parent.swimlaneToggleArray.length&&(l=-1!==this.parent.swimlaneToggleArray.indexOf(c.keyField)),this.parent.swimlaneSettings.keyField&&!this.parent.isAdaptive&&this.renderSwimlaneRow(o,c,l),this.renderSingleContent(o,c,l)}},j.prototype.renderSingleContent=function(t,e,n){for(var a=f.createElement("tr",{className:n?m+" "+w:m,attrs:{role:"row","aria-label":e.keyField+"row content"}}),r=0,i=this.parent.columns;r<i.length;r++){var o,l,s=i[r];this.isColumnVisible(s)&&(l=this.parent.actionModule.columnToggleArray.indexOf(s.keyField.toString()),o=(s.allowDrag?" "+Ve:"")+(s.allowDrop?" e-drop "+C:""),o=f.createElement("td",{className:(-1===l?u:u+" "+w)+o,attrs:{"data-role":"kanban-column","data-key":s.keyField.toString(),tabindex:"0","aria-describedby":s.keyField.toString(),role:"gridcell"}}),(s.allowToggle&&!s.isExpanded||-1!==l)&&(f.addClass([o],w),l=(s.showItemCount?"["+this.getColumnData(s.keyField,this.swimlaneData[e.keyField]).length+"] ":"")+s.headerText,o.appendChild(f.createElement("div",{className:it,innerHTML:l})),o.setAttribute("aria-expanded","false")),s.showAddButton&&((l=f.createElement("div",{className:x,attrs:{tabindex:"-1"}})).appendChild(f.createElement("div",{className:jt+" "+xe})),o.appendChild(l)),a.appendChild(o))}n=[{keyField:e.keyField,textField:e.textField,count:e.count}];this.parent.trigger(Y,{data:n,element:a,cancel:!1,requestType:"contentRow"},function(e){e.cancel||(t.classList.contains("e-swimlane-row")?t.insertAdjacentElement("beforebegin",a):t.appendChild(a))})},j.prototype.initializeSwimlaneTree=function(){var e,t;this.parent.swimlaneSettings.keyField&&this.parent.isAdaptive&&0!==this.parent.kanbanData.length&&(e=this.parent.element.querySelector("."+Ct),this.swimlaneRow=[this.kanbanRows[this.swimlaneIndex]],this.renderSwimlaneTree(),this.parent.swimlaneSettings.template?(t=this.swimlaneData[this.swimlaneRow[0].keyField].length,t=f.extend({},this.swimlaneRow[0],{count:t},!0),t=this.parent.templateParser(this.parent.swimlaneSettings.template)(t,this.parent,"swimlaneTemplate","",!1),e.appendChild(t[0])):e.innerHTML=this.swimlaneRow[0].textField)},j.prototype.renderSwimlaneRow=function(t,e,n){var a=f.createElement("tr",{className:"e-content-row e-swimlane-row"+(n?" "+w:""),attrs:{"aria-label":e.keyField+" row header",role:"row","data-key":e.keyField,"aria-expanded":(!n).toString()}}),r=this.parent.columns.length-this.parent.actionModule.hideColumnKeys.length,r=f.createElement("td",{className:u,attrs:{"data-role":"kanban-column",role:"gridcell",colspan:r.toString()}}),i=f.createElement("div",{className:O});r.appendChild(i);var o,n=f.createElement("div",{className:xe+" "+(n?v:Be),attrs:{tabindex:"0",role:"button","aria-label":n?e.keyField+" Collapse":e.keyField+" Expand"}}),n=(i.appendChild(n),f.createElement("div",{className:Te})),l=(i.appendChild(n),this.swimlaneData[e.keyField].length),s=(this.parent.swimlaneSettings.template?(o=f.extend({},e,{count:l},!0),f.addClass([r],De),s=this.parent.element.id+"_swimlaneTemplate",o=this.parent.templateParser(this.parent.swimlaneSettings.template)(o,this.parent,"swimlaneTemplate",s,!1),f.append(o,n)):n.appendChild(f.createElement("div",{className:"e-swimlane-text",innerHTML:e.textField,attrs:{"data-role":e.textField}})),this.parent.swimlaneSettings.showItemCount&&i.appendChild(f.createElement("div",{className:Ue,innerHTML:"- "+l.toString()+" "+this.parent.localeObj.getConstant("items")})),a.appendChild(r),[{keyField:e.keyField,textField:e.textField,count:e.count}]);this.parent.trigger(Y,{data:s,element:a,cancel:!1,requestType:"swimlaneRow"},function(e){e.cancel||(t.classList.contains("e-swimlane-row")?t.insertAdjacentElement("beforebegin",a):t.appendChild(a))})},j.prototype.renderCards=function(){var d=this,c=this.swimlaneRow,e=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),a=[].slice.call(this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row")),r=[],p=!1;e.forEach(function(o,l){for(var s=0,e=function(e){if(d.isColumnVisible(e)){var t=d.parent.swimlaneSettings.keyField?d.getColumnData(e.keyField,d.parent.swimlaneSettings.showEmptyRow&&f.isNullOrUndefined(d.swimlaneData[c[l].keyField])?[]:d.swimlaneData[c[l].keyField]):d.columnData[e.keyField],n=(s+=t.length,o.querySelector('[data-key="'+e.keyField+'"]')),a=f.createElement("div",{className:b,attrs:{role:"listbox",tabindex:"0","aria-label":e.keyField.toString()}});if(!(p=0<e.transitionColumns.length?!0:p)&&f.isNullOrUndefined(d.parent.swimlaneSettings.keyField)&&(e=f.createElement("div",{className:gt}),n.appendChild(e)),n.appendChild(a),0<t.length)for(var r=0,i=t;r<i.length;r++)!function(e){var t=e[d.parent.cardSettings.headerField],t=d.parent.actionModule.selectionArray.indexOf(t),n=d.renderCard(e);-1!==t&&(n.setAttribute("aria-selected","true"),f.addClass([n],k)),d.parent.trigger(W,{data:e,element:n,cancel:!1},function(e){e.cancel||a.appendChild(n)})}(i[r]);else a.appendChild(d.renderEmptyCard())}},t=0,n=d.parent.columns;t<n.length;t++)e(n[t]);0===s&&(r.push(o),0<a.length)&&r.push(a[l])}),this.parent.swimlaneSettings.showEmptyRow||0!==this.parent.kanbanData.length||this.parent.showEmptyColumn||r.forEach(function(e){return f.remove(e)})},j.prototype.renderCard=function(e){var t=f.createElement("div",{className:S,attrs:{"data-id":e[this.parent.cardSettings.headerField],"data-key":e[this.parent.keyField],"aria-selected":"false",tabindex:"-1",role:"option","aria-roledescription":"Card"}});if("auto"!==this.parent.cardHeight&&(t.style.height=f.formatUnit(this.parent.cardHeight)),this.parent.cardSettings.template){f.addClass([t],De);var n=this.parent.element.id+"_cardTemplate",n=this.parent.templateParser(this.parent.cardSettings.template)(e,this.parent,"cardTemplate",n,!1);f.append(n,t)}else{var a,r,n=this.parent.enableTooltip?" "+bt:"",i=(this.parent.cardSettings.showHeader&&(a=f.createElement("div",{className:We}),i=f.createElement("div",{className:Qe}),r=f.createElement("div",{className:Xe+n,innerHTML:e[this.parent.cardSettings.headerField]||""}),a.appendChild(i),i.appendChild(r),t.appendChild(a)),f.createElement("div",{className:Ye+n,innerHTML:e[this.parent.cardSettings.contentField]||""}));if(t.appendChild(i),this.parent.cardSettings.tagsField&&e[this.parent.cardSettings.tagsField]){for(var o=f.createElement("div",{className:Ge}),l=0,s=e[this.parent.cardSettings.tagsField].toString().split(",");l<s.length;l++){var d=s[l];o.appendChild(f.createElement("div",{className:Je+" "+$e,innerHTML:d}))}t.appendChild(o)}if(this.parent.cardSettings.grabberField&&e[this.parent.cardSettings.grabberField]&&(f.addClass([t],Ze),t.style.borderLeftColor=e[this.parent.cardSettings.grabberField]),this.parent.cardSettings.footerCssField){for(var c=f.createElement("div",{className:et}),p=0,h=e[this.parent.cardSettings.footerCssField].split(",");p<h.length;p++){var u=h[p];c.appendChild(f.createElement("div",{className:u.trim()+" "+nt}))}t.appendChild(c)}}return t},j.prototype.renderEmptyCard=function(){return f.createElement("span",{className:tt,innerHTML:this.parent.localeObj.getConstant("noCard"),attrs:{"aria-label":this.parent.localeObj.getConstant("noCard"),role:"option"}})},j.prototype.renderColGroup=function(e){var a=this,r=f.createElement("colgroup");this.parent.columns.forEach(function(e){var t,n;a.isColumnVisible(e)&&(n=a.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),t=e.allowToggle&&!e.isExpanded,n=f.createElement("col",{className:-1!==n||t?w:"",attrs:{"data-key":e.keyField.toString()},styles:a.parent.isAdaptive?"width: "+(t?f.formatUnit(50):f.formatUnit(a.getWidth())):""}),r.appendChild(n))}),e.appendChild(r)},j.prototype.getRows=function(){var a=this,r=[];return this.parent.swimlaneSettings.keyField&&(this.parent.kanbanData.map(function(e){if(a.parent.swimlaneSettings.showEmptyRow||!(f.isNullOrUndefined(e[a.parent.keyField])||""===e[a.parent.keyField]||e[a.parent.keyField]&&-1===a.columnKeys.indexOf(e[a.parent.keyField].toString()))){var t=e[a.parent.swimlaneSettings.textField]||e[a.parent.swimlaneSettings.keyField],n=e[a.parent.swimlaneSettings.keyField];if(!e[a.parent.swimlaneSettings.keyField]){if(!a.parent.swimlaneSettings.showUnassignedRow)return;t=a.parent.localeObj.getConstant("unassigned"),n=""}r.push({keyField:n,textField:t})}}),r=r.filter(function(e,t,n){return t===n.map(function(e){return e.keyField}).indexOf(e.keyField)}),(r=this.swimlaneSorting(r)).forEach(function(t){t.count=a.parent.kanbanData.filter(function(e){return-1<a.columnKeys.indexOf(e[a.parent.keyField])&&e[a.parent.swimlaneSettings.keyField]===t.keyField}).length}),0!==r.length)||r.push({keyField:"",textField:""}),r},j.prototype.swimlaneSorting=function(e){return this.parent.swimlaneSettings.sortComparer?e=this.parent.swimlaneSettings.sortComparer.call(this.parent,e):(e.sort(function(e,t){return e.textField.localeCompare(t.textField,void 0,{numeric:!0})}),"Descending"===this.parent.swimlaneSettings.sortDirection&&e.reverse()),e},j.prototype.createStackedRow=function(i){var e=f.createElement("tr",{className:Ie+" "+Le}),o=[];this.parent.columns.forEach(function(e){for(var t="",n=0,a=i;n<a.length;n++){var r=a[n];-1!==r.keyFields.indexOf(e.keyField.toString())&&(t=r.text)}o.push(t)});for(var t=0;t<o.length;t++){for(var n=1,a=t+1;a<o.length&&(""!==o[t]&&""!==o[a]&&o[t]===o[a]);a++)n++;var r=f.createElement("div",{className:qe,innerHTML:o[t]}),l=f.createElement("th",{className:p+" "+Pe,attrs:{colspan:n.toString(),scope:"col"}});e.appendChild(l).appendChild(r),t+=n-1}return e},j.prototype.scrollUiUpdate=function(){var e,n=this,t=this.parent.element.querySelector("."+c),a=this.parent.element.querySelector("."+g),r=this.parent.element.offsetHeight-t.offsetHeight;this.parent.isAdaptive&&(r=window.innerHeight-(t.offsetHeight+25),(e=this.parent.element.querySelector("."+O))&&(r-=e.offsetHeight),[].slice.call(this.parent.element.querySelectorAll("."+u)).forEach(function(e){var t=e.querySelector("."+b);t.classList.contains(yt)||(t.style.height=f.formatUnit(r),f.EventHandler.add(e,"touchmove",n.onAdaptiveScroll,n))})),"auto"!==this.parent.height&&"100%"!==this.parent.height&&(a.style.height=f.formatUnit(r)),[].slice.call(t.children).forEach(function(e){var t=0;0<a.offsetWidth-a.clientWidth&&(t=17,0<a.offsetHeight-a.clientHeight)&&(e.style.width=f.formatUnit(a.clientWidth)),n.parent.enableRtl?e.style.paddingLeft=f.formatUnit(t):e.style.paddingRight=f.formatUnit(t)}),this.updateScrollPosition()},j.prototype.onContentScroll=function(e){var t=e.target,n=this.parent.element.querySelector("."+c);[].slice.call(n.children).forEach(function(e){e.scrollLeft=t.scrollLeft}),this.parent.scrollPosition.content={left:t.scrollLeft,top:t.scrollTop},!f.isNullOrUndefined(this.parent.swimlaneSettings.keyField)&&this.parent.swimlaneSettings.enableFrozenRows&&this.frozenRows(e)},j.prototype.addFrozenSwimlaneDataKey=function(e){e=e.getAttribute("data-key");f.isNullOrUndefined(e)||this.frozenSwimlaneRow.setAttribute("data-key",e)},j.prototype.frozenRows=function(e){var t,n,a,r,i,o=this.parent.element.querySelector("."+y),l=this.parent.element.querySelector("."+c),s=this.parent.element.querySelector("."+g);f.isNullOrUndefined(this.frozenSwimlaneRow)?(this.frozenSwimlaneRow=f.createElement("div",{className:Rt}),t=f.createElement("div",{className:Lt}),this.frozenSwimlaneRow.appendChild(t),this.parent.element.insertBefore(this.frozenSwimlaneRow,this.parent.element.firstElementChild),t.appendChild(o.querySelector("."+O).cloneNode(!0)),this.addFrozenSwimlaneDataKey(o),f.setStyleAttribute(this.frozenSwimlaneRow,{height:f.formatUnit(o.getBoundingClientRect().height),width:f.formatUnit(s.querySelector(".e-swimlane").getBoundingClientRect().width),top:f.formatUnit(l.getBoundingClientRect().height.toString())}),f.setStyleAttribute(l,{position:"relative",top:f.formatUnit(-this.frozenSwimlaneRow.getBoundingClientRect().height)}),f.setStyleAttribute(s,{position:"relative",top:f.formatUnit(-this.frozenSwimlaneRow.getBoundingClientRect().height)})):(o=(t=[].slice.call(this.parent.element.querySelectorAll("."+y)))[this.frozenOrder],l=t[this.frozenOrder-1],n=t[this.frozenOrder+1],i=r=a=void 0,o&&(a=o.getBoundingClientRect().top+o.getBoundingClientRect().height),l&&(r=l.getBoundingClientRect().top+l.getBoundingClientRect().height),n&&(i=n.getBoundingClientRect().top+n.getBoundingClientRect().height),o=s.getBoundingClientRect().top+this.frozenSwimlaneRow.getBoundingClientRect().height,s=this.frozenSwimlaneRow.querySelector("."+Lt),i&&i<=o&&this.frozenOrder<t.length-1?(s&&(f.remove(s.querySelector("."+O)),s.appendChild(n.querySelector("."+O).cloneNode(!0)),this.addFrozenSwimlaneDataKey(n)),++this.frozenOrder):r&&o<a&&r<o&&0<this.frozenOrder&&(s&&(f.remove(s.querySelector("."+O)),s.appendChild(l.querySelector("."+O).cloneNode(!0)),this.addFrozenSwimlaneDataKey(l)),--this.frozenOrder)),e&&0===e.target.scrollTop&&this.removeFrozenRows()},j.prototype.removeFrozenRows=function(){f.remove(this.frozenSwimlaneRow),this.frozenSwimlaneRow=null;var e=this.parent.element.querySelector("."+c),t=this.parent.element.querySelector("."+g);f.setStyleAttribute(e,{position:"",top:""}),f.setStyleAttribute(t,{position:"",top:""}),this.parent.scrollPosition.content={left:this.parent.scrollPosition.content.left,top:0},t.scrollTop=0,this.frozenOrder=0},j.prototype.onColumnScroll=function(e){var t,e=e.target;e.offsetParent&&(t=e.offsetParent.getAttribute("data-key"),this.parent.scrollPosition.column[""+t]={left:e.scrollLeft,top:e.scrollTop})},j.prototype.onAdaptiveScroll=function(e){this.parent.touchModule.tabHold&&!this.parent.touchModule.mobilePopup&&e.preventDefault()},j.prototype.isColumnVisible=function(e){var t=this,n=!1;return"number"==typeof e.keyField?n=-1===this.parent.actionModule.hideColumnKeys.indexOf(e.keyField.toString()):e.keyField.split(",").forEach(function(e){n=-1===t.parent.actionModule.hideColumnKeys.indexOf(e)}),n},j.prototype.renderLimits=function(e,t){var n=f.createElement("div",{className:Ot});e.minCount&&n.appendChild(f.createElement("div",{className:Dt,innerHTML:this.parent.localeObj.getConstant("min")+": "+e.minCount.toString()})),e.maxCount&&n.appendChild(f.createElement("div",{className:xt,innerHTML:this.parent.localeObj.getConstant("max")+": "+e.maxCount.toString()})),0<n.childElementCount&&(t.querySelector("."+b)?t.insertBefore(n,t.firstElementChild):t.appendChild(n))},j.prototype.renderValidation=function(){var o=this;this.parent.columns.forEach(function(a){var r,e,i,t;(a.minCount||a.maxCount)&&(r=o.columnData[a.keyField],t='[data-key="'+a.keyField+'"]',e=o.parent.element.querySelector("."+p+t),i=[].slice.call(o.parent.element.querySelectorAll("."+u+t)),"Swimlane"===o.parent.constraintType&&o.parent.swimlaneSettings.keyField?o.swimlaneRow.forEach(function(t,e){o.renderLimits(a,i[e]);var n=r.filter(function(e){return e[o.parent.swimlaneSettings.keyField]===t.keyField}),n=o.getValidationClass(a,n.length);n&&f.addClass([i[e]],n)}):(o.renderLimits(a,e),(t=o.getValidationClass(a,r.length))&&f.addClass(i.concat(e),t)))})},j.prototype.getValidationClass=function(e,t){var n;return e.maxCount&&t>e.maxCount?n=At:e.minCount&&t<e.minCount&&(n=Ft),n},j.prototype.refreshValidation=function(){[].slice.call(this.parent.element.querySelectorAll("."+Ot)).forEach(function(e){f.remove(e)});var e=[].slice.call(this.parent.element.querySelectorAll("."+Ft)),e=(f.removeClass(e,Ft),[].slice.call(this.parent.element.querySelectorAll("."+At)));f.removeClass(e,At),this.renderValidation()},j.prototype.getColumnData=function(t,n){var a=this,r=(void 0===n&&(n=this.parent.kanbanData),[]);if("number"==typeof t)var e=n.filter(function(e){return e[a.parent.keyField]===t}),r=r.concat(e);else for(var i=0,o=t.split(",");i<o.length;i++)!function(t){var e=n.filter(function(e){return e[a.parent.keyField]===t.trim()});r=r.concat(e)}(o[i]);return this.sortCategory(r),r},j.prototype.sortCategory=function(e){var t=this.parent.cardSettings.headerField,n=this.parent.sortSettings.direction;switch(this.parent.sortSettings.sortBy){case"DataSourceOrder":this.sortOrder(t,n,e);break;case"Custom":case"Index":this.parent.sortSettings.field&&(t=this.parent.sortSettings.field),this.sortOrder(t,n,e)}return e},j.prototype.sortOrder=function(n,e,t){var a,r,i=!0;return!(i=0<this.parent.kanbanData.length?"number"==typeof this.parent.kanbanData[0][""+n]:i)&&"Index"===this.parent.sortSettings.sortBy||(t=t.sort(function(e,t){return(r=i?(a=e[""+n],t[""+n]):(a=e[""+n].toLowerCase(),t[""+n].toLowerCase()))<a?1:a<r?-1:0}),"Descending"!==e)||t.reverse(),t},j.prototype.documentClick=function(e){e.target.classList.contains(wt)&&this.parent.element.querySelector("."+kt).classList.contains("e-popup-open")&&(this.treePopup.hide(),f.removeClass([this.popupOverlay],"e-enable")),f.closest(e.target,"."+Ee)||(e=[].slice.call(this.parent.element.querySelectorAll(".e-card."+k)),f.removeClass(e,k),this.disableAttributeSelection(e))},j.prototype.disableAttributeSelection=function(e){e instanceof Element?e.setAttribute("aria-selected","false"):e.forEach(function(e){e.setAttribute("aria-selected","false")})},j.prototype.getColumnCards=function(n){var a=this,r={};return this.columnKeys=[],this.parent.columns.forEach(function(e){var t="number"==typeof e.keyField,t=(a.columnKeys=t?a.columnKeys.concat(e.keyField.toString()):a.columnKeys.concat(e.keyField.split(",").map(function(e){return e.trim()})),a.getColumnData(e.keyField,n));r[e.keyField]=t}),r},j.prototype.getSwimlaneCards=function(){var n=this,e={};return this.parent.swimlaneSettings.keyField&&this.kanbanRows.forEach(function(t){return e[t.keyField]=n.parent.kanbanData.filter(function(e){return!f.isNullOrUndefined(e[n.parent.keyField])&&-1<n.columnKeys.indexOf(e[n.parent.keyField].toString())&&(!e[n.parent.swimlaneSettings.keyField]&&n.parent.swimlaneSettings.showUnassignedRow?"":e[n.parent.swimlaneSettings.keyField])===t.keyField})}),e},j.prototype.refreshHeaders=function(){var e=this.parent.element.querySelector("."+c);[].slice.call(e.children).forEach(function(e){return f.remove(e)}),this.renderHeader(e)},j.prototype.refreshCards=function(){this.parent.resetTemplates(["cardTemplate"]),[].slice.call(this.parent.element.querySelectorAll("."+b)).forEach(function(e){return f.remove(e)}),this.renderCards(),this.wireDragEvent(),this.parent.renderTemplates()},j.prototype.refresh=function(){var o=this,l=!1;this.parent.columns.forEach(function(e){if(e.showItemCount){e&&e.template&&!l&&(o.refreshHeaders(),l=!0);var t="."+p+'[data-key="'+e.keyField+'"] .'+Ue,t=o.parent.element.querySelector(t);if(t){var n=0;if("number"==typeof e.keyField)n=[].slice.call(o.parent.element.querySelectorAll('.e-card[data-key="'+e.keyField+'"]')).length;else for(var a=0,r=e.keyField.split(",");a<r.length;a++)var i=r[a],n=[].slice.call(o.parent.element.querySelectorAll('.e-card[data-key="'+i.trim()+'"]')).length+n;t.innerHTML="- "+n+" "+o.parent.localeObj.getConstant("items")}}}),this.parent.swimlaneSettings.keyField&&[].slice.call(this.parent.element.querySelectorAll("."+y)).forEach(function(e){var t=e.getAttribute("data-key"),n=e.querySelector("."+Ue);n&&t&&(t=[].slice.call(e.nextElementSibling.querySelectorAll("."+S)),n.innerHTML="- "+t.length+" "+o.parent.localeObj.getConstant("items"))}),this.refreshValidation()},j.prototype.updateScrollPosition=function(){var n=this,e=this.parent.element.querySelector("."+g);e&&(f.Browser.isIE?(e.scrollTop=this.parent.scrollPosition.content.top,e.scrollLeft=this.parent.scrollPosition.content.left):e.scrollTo(this.parent.scrollPosition.content.left,this.parent.scrollPosition.content.top)),[].slice.call(this.parent.element.querySelectorAll("."+b)).forEach(function(e){var t;e.offsetParent&&(t=n.parent.scrollPosition.column[e.offsetParent.getAttribute("data-key")])&&(f.Browser.isIE?(e.scrollTop=t.top,e.scrollLeft=t.left):e.scrollTo(t.left,t.top))})},j.prototype.renderCardBasedOnIndex=function(t,n){var e,a,r,i,o,l,s,d=this,c=t[this.parent.keyField],p=this.parent.element.querySelector(".e-content-row:not(.e-swimlane-row)");this.parent.swimlaneSettings.keyField&&!this.parent.isAdaptive&&(e='.e-content-row.e-swimlane-row[data-key="'+t[this.parent.swimlaneSettings.keyField]+'"]',this.parent.element.querySelector(e)?p=this.parent.element.querySelector(e).nextElementSibling:(-1!==this.columnKeys.indexOf(c)&&-1===this.parent.actionModule.hideColumnKeys.indexOf(c)&&(l=this.kanbanRows.findIndex(function(e){return e.keyField===t[d.parent.swimlaneSettings.keyField]}),r=[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row")),i=this.parent.element.querySelector("."+Ne+" tbody"),r[l]&&(i=r[l]),this.renderSwimlaneRow(i,this.kanbanRows[l],!1),this.renderSingleContent(i,this.kanbanRows[l],!1)),p=this.parent.element.querySelector(e).nextElementSibling,[].slice.call(p.children).forEach(function(e){var t=f.createElement("div",{className:b});e.appendChild(t),t.appendChild(d.renderEmptyCard())}))),"Index"!==this.parent.sortSettings.sortBy?(a=this.parent.cardSettings.headerField,"Custom"===this.parent.sortSettings.sortBy&&(a=this.parent.sortSettings.field),n=f.isNullOrUndefined(this.parent.swimlaneSettings.keyField)?this.getColumnData(c,this.parent.kanbanData).findIndex(function(e){return e[""+a]===t[""+a]}):(r=this.parent.getSwimlaneData(t[this.parent.swimlaneSettings.keyField]),this.getColumnData(c,r).findIndex(function(e){return e[""+a]===t[""+a]}))):"Index"===this.parent.sortSettings.sortBy&&this.parent.sortSettings.field&&"Ascending"===this.parent.sortSettings.direction&&(n=t[this.parent.sortSettings.field]-1),p&&(i=[].slice.call(p.children).filter(function(e){return-1!==e.getAttribute("data-key").replace(/\s/g,"").split(",").indexOf(c.toString().replace(/\s/g,""))})[0],(l=(o=i.querySelector("."+b)).querySelector("."+tt))&&f.remove(l),s=this.renderCard(t),this.parent.allowDragAndDrop&&i.classList.contains(Ve)&&(this.parent.dragAndDropModule.wireDragEvents(s),f.addClass([s],C)),this.parent.trigger(W,{data:t,element:s,cancel:!1},function(e){e.cancel||(f.isNullOrUndefined(n)||0===o.children.length?o.appendChild(s):o.insertBefore(s,o.childNodes[n]))}))},j.prototype.removeCard=function(e){var e=e[this.parent.cardSettings.headerField],e=this.parent.element.querySelector('.e-card[data-id="'+e+'"]'),t=(this.isSelectedCard=!!e.classList.contains(k),e.parentElement);e&&f.remove(e),0===t.querySelectorAll(".e-card:not(."+pt+")").length&&t.appendChild(this.renderEmptyCard())},j.prototype.wireEvents=function(){var t=this,e=(f.EventHandler.add(this.parent.element,"click",this.parent.actionModule.clickHandler,this.parent.actionModule),f.EventHandler.add(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler,this.parent.actionModule),f.EventHandler.add(document,f.Browser.touchStartEvent,this.documentClick,this),this.parent.element.querySelector("."+g));f.EventHandler.add(e,"scroll",this.onContentScroll,this),[].slice.call(this.parent.element.querySelectorAll("."+b)).forEach(function(e){t.parent.isInitialRender&&e.offsetParent&&(t.parent.scrollPosition.column[e.offsetParent.getAttribute("data-key")]={left:0,top:0}),f.EventHandler.add(e,"scroll",t.onColumnScroll,t)}),this.parent.isAdaptive&&(this.parent.touchModule.wireTouchEvents(),e.scrollLeft=this.scrollLeft),this.wireDragEvent()},j.prototype.unWireEvents=function(){var t=this,e=(f.EventHandler.remove(this.parent.element,"click",this.parent.actionModule.clickHandler),f.EventHandler.remove(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler),f.EventHandler.remove(document,f.Browser.touchStartEvent,this.documentClick),this.parent.element.querySelector("."+g)),e=(e&&(f.EventHandler.remove(e,"scroll",this.onContentScroll),this.parent.allowDragAndDrop)&&this.unWireDragEvent(),[].slice.call(this.parent.element.querySelectorAll("."+b)));0<e.length&&e.forEach(function(e){f.EventHandler.remove(e,"scroll",t.onColumnScroll)}),this.parent.isAdaptive&&this.parent.touchModule.unWireTouchEvents()},j.prototype.wireDragEvent=function(){var e,t=this;this.parent.allowDragAndDrop&&(e=[].slice.call(this.parent.element.querySelectorAll("."+u+"."+Ve+" ."+S)),f.addClass(e,C),e.forEach(function(e){return t.parent.dragAndDropModule.wireDragEvents(e)}))},j.prototype.unWireDragEvent=function(){var t=this,e=[].slice.call(this.parent.element.querySelectorAll("."+u+"."+Ve+" ."+S));f.removeClass(e,C),e.forEach(function(e){return t.parent.dragAndDropModule.unWireDragEvents(e)})},j.prototype.destroy=function(){this.parent.resetTemplates(),this.parent.off(i,this.initRender),this.parent.off(h,this.scrollUiUpdate),this.unWireEvents();var e=this.parent.element.querySelector("."+c),e=(e&&f.remove(e),this.parent.element.querySelector("."+g)),e=(e&&f.remove(e),this.treeViewObj&&(this.treeViewObj.destroy(),this.treeViewObj=null),this.treePopup&&(this.treePopup.destroy(),this.treePopup=null),this.parent.element.querySelector("."+O)),e=(e&&f.remove(e),this.parent.element.querySelector("."+Et));e&&f.remove(e)};var Wt,Yt,Qt=j;function j(e){var t=Yt.call(this,e)||this;return t.kanbanRows=[],t.parent=e,t.columnKeys=[],t.swimlaneIndex=0,t.swimlaneData={},t.scrollLeft=0,t.frozenOrder=0,t.parent.on(i,t.initRender,t),t.parent.on(h,t.scrollUiUpdate,t),t}Xt=function(e,t){return(Xt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};(function(e,t){function n(){this.constructor=e}Xt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)})(q,Gt=Ce),q.prototype.initRender=function(){var e;this.isSwimlane=!f.isNullOrUndefined(this.parent.swimlaneSettings.keyField)&&1<this.parent.swimlaneSettings.keyField.trim().length,this.query=this.parent.query instanceof s.Query?this.parent.query:new s.Query,0!==this.parent.columns.length&&(this.cardHeight=this.cardHeightCalculate(),this.columnData=this.getColumnCards(),this.kanbanRows=this.getRows(),this.parent.isAdaptive&&(e=this.parent.element.querySelector("."+g))&&(this.scrollLeft=e.scrollLeft),this.destroy(),this.parent.on(i,this.initRender,this),this.parent.on(h,this.scrollUiUpdate,this),e=f.createElement("div",{className:c}),this.parent.element.appendChild(e),this.renderHeader(e),this.isSwimlane||(this.renderContent(),this.renderCards()),this.renderValidation(),this.parent.renderTemplates(),this.parent.notify(h,{}),this.wireEvents(),this.parent.isInitialRender)&&(this.parent.isInitialRender=!1)},q.prototype.cardHeightCalculate=function(){var e="auto"===this.parent.cardHeight?108:parseInt(f.formatUnit(this.parent.cardHeight).split("px")[0],10)+8;return e},q.prototype.renderHeader=function(e){for(var t=f.createElement("div",{className:this.parent.swimlaneSettings.keyField?Ae:""}),e=(e.appendChild(t),f.createElement("table",{className:Fe+" "+Me,attrs:{role:"presentation"}})),t=(t.appendChild(e),this.renderColGroup(e),f.createElement("thead")),s=(e.appendChild(t),0<this.parent.stackedHeaders.length&&t.appendChild(this.createStackedRow(this.parent.stackedHeaders)),f.createElement("tr",{className:Ie})),d=(t.appendChild(s),this),n=0,a=this.parent.columns;n<a.length;n++)!function(e){var t,n,a,r,i,o,l;d.isColumnVisible(e)&&(t=d.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),n=f.createElement("th",{className:-1===t?p:p+" "+w,attrs:{"data-role":"kanban-column","data-key":e.keyField.toString()}}),a=[],e.allowToggle&&(a.push(He),e.isExpanded||a.push(w)),f.addClass([n],a),a=f.createElement("div",{className:Te}),n.appendChild(a),r=d.parent.dataModule.isRemote()?d.parent.columnDataCount[e.keyField]:d.columnData[e.keyField].length,o=f.createElement("div",{className:je}),a.appendChild(o),e.template?(l={keyField:e.keyField,headerText:e.headerText,minCount:e.minCount,maxCount:e.maxCount,allowToggle:e.allowToggle,isExpanded:e.isExpanded,showItemCount:e.showItemCount,count:r},f.addClass([n],De),i=d.parent.element.id+"_columnTemplate",l=d.parent.templateParser(e.template)(l,d.parent,"columnTemplate",i,!1),f.append(l,o)):(i=f.createElement("div",{className:qe,innerHTML:e.headerText}),o.appendChild(i),e.showItemCount&&(l=f.createElement("div",{className:Ue,innerHTML:"- "+r.toString()+" "+d.parent.localeObj.getConstant("items")}),o.appendChild(l))),e.allowToggle&&(i=!(!e.isExpanded||-1!==t),(o=f.createElement("div",{className:Re+" "+xe+" "+(i?at:rt),attrs:{tabindex:"0"}})).setAttribute("aria-label",i?e.keyField+" Expand":e.keyField+" Collapse"),n.setAttribute("aria-expanded",i.toString()),a.appendChild(o)),l=[{keyField:e.keyField,textField:e.headerText,count:r}],d.parent.trigger(Y,{data:l,element:s,cancel:!1,requestType:"headerRow"},function(e){e.cancel||s.appendChild(n)}))}(a[n])},q.prototype.renderContent=function(){for(var e=f.createElement("div",{className:g}),t=(this.parent.element.appendChild(e),f.createElement("div",{className:this.parent.swimlaneSettings.keyField?Ae:""})),e=(e.appendChild(t),f.createElement("table",{className:Fe+" "+Ne,attrs:{role:"presentation"}})),n=(t.appendChild(e),this.renderColGroup(e),f.createElement("tbody")),a=(e.appendChild(n),!1),r=0,i=this.kanbanRows;r<i.length;r++){var o=i[r];this.parent.swimlaneSettings.keyField&&0!==this.parent.swimlaneToggleArray.length&&(a=-1!==this.parent.swimlaneToggleArray.indexOf(o.keyField)),this.renderSingleContent(n,o,a)}},q.prototype.renderSingleContent=function(t,e,n){for(var a=f.createElement("tr",{className:n?m+" "+w:m,attrs:{"aria-expanded":"true"}}),r=0,i=this.parent.columns;r<i.length;r++){var o,l,s=i[r];this.isColumnVisible(s)&&(l=this.parent.actionModule.columnToggleArray.indexOf(s.keyField.toString()),o=(s.allowDrag?" "+Ve:"")+(s.allowDrop?" e-drop "+C:""),o=f.createElement("td",{className:(-1===l?u:u+" "+w)+o,attrs:{"data-role":"kanban-column","data-key":s.keyField.toString(),"aria-expanded":"true",tabindex:"0",role:"navigation"}}),(s.allowToggle&&!s.isExpanded||-1!==l)&&(f.addClass([o],w),l=(s.showItemCount?"["+(this.parent.dataModule.isRemote()?this.parent.columnDataCount[s.keyField]:this.getColumnData(s.keyField).length)+"] ":"")+s.headerText,o.appendChild(f.createElement("div",{className:it,innerHTML:l})),o.setAttribute("aria-expanded","false")),s.showAddButton&&((l=f.createElement("div",{className:x,attrs:{tabindex:"-1"}})).appendChild(f.createElement("div",{className:jt+" "+xe})),o.appendChild(l)),a.appendChild(o),this.parent.enableVirtualization)&&(s=this.parent.element.querySelector(".e-kanban-header").getBoundingClientRect().height,"auto"===this.parent.height?o.style.height=window.innerHeight-(s+this.parent.element.getBoundingClientRect().top+15)+"px":o.style.height=parseInt(f.formatUnit(this.parent.height).split("px")[0],10)-(s+15)+"px")}n=[{keyField:e.keyField,textField:e.textField,count:e.count}];this.parent.trigger(Y,{data:n,element:a,cancel:!1,requestType:"contentRow"},function(e){e.cancel||(t.classList.contains("e-swimlane-row")?t.insertAdjacentElement("beforebegin",a):t.appendChild(a))})},q.prototype.windowResize=function(){for(var e=this.parent.element.querySelectorAll("."+u),t=this.parent.element.querySelector(".e-kanban-header").getBoundingClientRect().height,n=0;n<e.length;n++)"auto"===this.parent.height?e[n].style.height=window.innerHeight-(t+this.parent.element.getBoundingClientRect().top+15)+"px":e[n].style.height=parseInt(f.formatUnit(this.parent.height).split("px")[0],10)-(t+15)+"px"},q.prototype.refreshColumnData=function(u,g,e,t){var m=this,n=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),y=("cardChanged"===e||"cardCreated"===e||"cardRemoved"===e)&&!f.isNullOrUndefined(t);n.forEach(function(h){for(var e=0,t=m.parent.columns;e<t.length;e++)!function(e){if(m.isColumnVisible(e)&&(e.keyField===u||e.keyField===g)||y){var t=0,n=m.getColumnCards()[e.keyField],n=m.parent.dataModule.isRemote()?m.parent.columnDataCount[e.keyField]:n.length,a=m.cardHeight*n,r=Array.apply(null,Array(n)).map(function(){return++t}),i=h.querySelector('[data-key="'+e.keyField+'"]'),o=Math.ceil(parseInt(i.style.height.split("px")[0],10)/m.cardHeight);m.offsets[1]=o*m.cardHeight;for(var l=1;l<r.length;l++)m.offsets[r[l]]=m.offsets[r[l-1]]+o*m.cardHeight,m.tempOffsets[r[l]]=0|m.offsets[r[l]-1];var s=i.querySelector("."+b),d=n%2==0?n-2:n-1,c=m.getInfoFromView(m.scrollStatus[e.keyField]),c=m.getTranslateY(c),p=s.querySelector("."+ze);p.style.maxHeight=n*m.cardHeight+"px",m.setPadding(c,p,n),m.currentStatus={column:e.keyField,columnOverAllHeight:a,columnHeight:parseInt(i.style.height.split("px")[0],10),previousScrollTop:m.scrollStatus[e.keyField].currentScrollTop,currentScrollTop:s.scrollTop,scrollDirection:m.scrollStatus[e.keyField].scrollDirection,currentBlockIndex:m.scrollStatus[e.keyField].currentBlockIndex,oldBlockIndex:m.scrollStatus[e.keyField].oldBlockIndex,offsets:m.offsets,tempOffsets:m.tempOffsets,totalColumnData:n,singleIndexCardCount:o,maxBlock:d},m.scrollStatus[e.keyField]=m.currentStatus}}(t[e])})},q.prototype.renderCards=function(){var g=this,e=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),r=[].slice.call(this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row")),i=[],m=!1;e.forEach(function(h,e){for(var u=0,t=function(e){if(g.isColumnVisible(e)){var t=0,a=(g.offsets={},g.tempOffsets={},g.columnData[e.keyField]),n=g.parent.dataModule.isRemote()?g.parent.columnDataCount[e.keyField]:a.length,r=(u+=n,g.cardHeight*n+7),i=h.querySelector('[data-key="'+e.keyField+'"]'),o=Math.ceil(parseFloat(i.style.height.split("px")[0])/g.cardHeight),l=n<o?n:Math.floor(n/o),s=Array.apply(null,Array(n)).map(function(){return++t});g.offsets[1]=o*g.cardHeight+7;for(var d=1;d<s.length;d++)g.offsets[s[d]]=g.offsets[s[d-1]]+o*g.cardHeight,g.tempOffsets[s[d]]=0|g.offsets[s[d]-1];var c=f.createElement("div",{className:b,attrs:{role:"listbox"}}),p=f.createElement("div",{className:ze,attrs:{role:"listbox"}}),l=(c.appendChild(p),l%2==0?l:l+1);if(g.currentStatus={column:e.keyField,columnOverAllHeight:r,columnHeight:parseInt(i.style.height.split("px")[0],10),previousScrollTop:null,currentScrollTop:c.scrollTop,scrollDirection:null,currentBlockIndex:[1,2],oldBlockIndex:[1,2],offsets:g.offsets,tempOffsets:g.tempOffsets,totalColumnData:n,singleIndexCardCount:o,maxBlock:l},g.scrollStatus[e.keyField]=g.currentStatus,!(m=0<e.transitionColumns.length?!0:m)&&f.isNullOrUndefined(g.parent.swimlaneSettings.keyField)&&(r=f.createElement("div",{className:gt}),i.appendChild(r)),i.appendChild(c),0<n){for(d=0;d<2*o&&d<a.length;d++)!function(e){var t=a[e][g.parent.cardSettings.headerField],t=g.parent.actionModule.selectionArray.indexOf(t),n=g.renderCard(a[e]),t=(-1!==t&&(n.setAttribute("aria-selected","true"),f.addClass([n],k)),{data:a[e],element:n,cancel:!1});g.parent.trigger(W,t,function(e){e.cancel||p.appendChild(n)})}(d);p.style.maxHeight=g.cardHeight*n+"px"}else p.appendChild(g.renderEmptyCard());g.setPadding(0,p,n)}},n=0,a=g.parent.columns;n<a.length;n++)t(a[n]);0===u&&(i.push(h),0<r.length)&&i.push(r[e])}),this.parent.swimlaneSettings.showEmptyRow||0!==this.parent.kanbanData.length||this.parent.showEmptyColumn||i.forEach(function(e){return f.remove(e)})},q.prototype.renderCard=function(e){var t=f.createElement("div",{className:S,attrs:{"data-id":e[this.parent.cardSettings.headerField],"data-key":e[this.parent.keyField],"aria-selected":"false",tabindex:"-1",role:"option"}});if(t.style.height=this.cardHeight-8+"px",this.parent.cardSettings.template){f.addClass([t],De);var n=this.parent.element.id+"_cardTemplate",n=this.parent.templateParser(this.parent.cardSettings.template)(e,this.parent,"cardTemplate",n,!1);f.append(n,t)}else{var a,r,n=this.parent.enableTooltip?" "+bt:"",i=(this.parent.cardSettings.showHeader&&(a=f.createElement("div",{className:We}),i=f.createElement("div",{className:Qe}),r=f.createElement("div",{className:Xe+n,innerHTML:e[this.parent.cardSettings.headerField]||""}),a.appendChild(i),i.appendChild(r),t.appendChild(a)),f.createElement("div",{className:Ye+n,innerHTML:e[this.parent.cardSettings.contentField]||""}));if(t.appendChild(i),this.parent.cardSettings.tagsField&&e[this.parent.cardSettings.tagsField]){for(var o=f.createElement("div",{className:Ge}),l=0,s=e[this.parent.cardSettings.tagsField].toString().split(",");l<s.length;l++){var d=s[l];o.appendChild(f.createElement("div",{className:Je+" "+$e,innerHTML:d}))}t.appendChild(o)}if(this.parent.cardSettings.grabberField&&e[this.parent.cardSettings.grabberField]&&(f.addClass([t],Ze),t.style.borderLeftColor=e[this.parent.cardSettings.grabberField]),this.parent.cardSettings.footerCssField){for(var c=f.createElement("div",{className:et}),p=0,h=e[this.parent.cardSettings.footerCssField].split(",");p<h.length;p++){var u=h[p];c.appendChild(f.createElement("div",{className:u.trim()+" "+nt}))}t.appendChild(c)}}return t},q.prototype.renderEmptyCard=function(){return f.createElement("span",{className:tt,innerHTML:this.parent.localeObj.getConstant("noCard")})},q.prototype.renderColGroup=function(e){var a=this,r=f.createElement("colgroup");this.parent.columns.forEach(function(e){var t,n;a.isColumnVisible(e)&&(n=a.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),t=e.allowToggle&&!e.isExpanded,n=f.createElement("col",{className:-1!==n||t?w:"",attrs:{"data-key":e.keyField.toString()},styles:a.parent.isAdaptive?"width: "+(t?f.formatUnit(50):f.formatUnit(a.getWidth())):""}),r.appendChild(n))}),e.appendChild(r)},q.prototype.getRows=function(){var e=[];return e.push({keyField:"",textField:""}),e},q.prototype.createStackedRow=function(i){var e=f.createElement("tr",{className:Ie+" "+Le}),o=[];this.parent.columns.forEach(function(e){for(var t="",n=0,a=i;n<a.length;n++){var r=a[n];-1!==r.keyFields.indexOf(e.keyField.toString())&&(t=r.text)}o.push(t)});for(var t=0;t<o.length;t++){for(var n=1,a=t+1;a<o.length&&(""!==o[t]&&""!==o[a]&&o[t]===o[a]);a++)n++;var r=f.createElement("div",{className:qe,innerHTML:o[t]}),l=f.createElement("th",{className:p+" "+Pe,attrs:{colspan:n.toString()}});e.appendChild(l).appendChild(r),t+=n-1}return e},q.prototype.scrollUiUpdate=function(){var e,n=this,t=this.parent.element.querySelector("."+c),a=this.parent.element.querySelector("."+g),r=this.parent.element.offsetHeight-t.offsetHeight;this.parent.isAdaptive&&(r=window.innerHeight-(t.offsetHeight+25),(e=this.parent.element.querySelector("."+O))&&(r-=e.offsetHeight),[].slice.call(this.parent.element.querySelectorAll("."+u)).forEach(function(e){var t=e.querySelector("."+b);t.classList.contains(yt)||(t.style.height=f.formatUnit(r),f.EventHandler.add(e,"touchmove",n.onAdaptiveScroll,n))})),"auto"!==this.parent.height&&"100%"!==this.parent.height&&(a.style.height=f.formatUnit(r)),[].slice.call(t.children).forEach(function(e){var t=0;0<a.offsetWidth-a.clientWidth&&(t=17,0<a.offsetHeight-a.clientHeight)&&(e.style.width=f.formatUnit(a.clientWidth)),n.parent.enableRtl?e.style.paddingLeft=f.formatUnit(t):e.style.paddingRight=f.formatUnit(t)}),this.updateScrollPosition()},q.prototype.onContentScroll=function(e){var t=e.target,e=this.parent.element.querySelector("."+c);[].slice.call(e.children).forEach(function(e){e.scrollLeft=t.scrollLeft}),this.parent.scrollPosition.content={left:t.scrollLeft,top:t.scrollTop}},q.prototype.getOffset=function(e,t){return Math.min(0|t.offsets[e],0|t.offsets[t.maxBlock])},q.prototype.getTranslateY=function(e){var t=(e.newBlockIndex[0]||1)-1,n=this.getOffset(t,e),a=this.getOffset(e.newBlockIndex[e.newBlockIndex.length-1],e);return n>e.currentScrollTop?this.getOffset(t-1,e):a<e.currentScrollTop+e.columnHeight?this.getOffset(1+t,e):n},q.prototype.setPadding=function(e,t,n,a,r){a&&"down"===r?(t.style.paddingTop=e+"px",t.style.paddingBottom="0px"):(t.style.paddingTop=e+"px",t.style.paddingBottom=this.cardHeight*n-e+"px")},q.prototype.getData=function(e,t,n,a){var r=this.query.clone(),e=new s.Predicate(e,"equal",t,!0);return r.where(e),r.take(n),r.skip(a),r.addParams("KanbanVirtualScroll","KanbanVirtualScroll"),this.parent.dataSource&&"result"in this.parent.dataSource?this.eventPromise({requestType:""},r).promise:this.parent.dataModule.dataManager.executeQuery(r)},q.prototype.eventPromise=function(e,t){var t=this.getStateEventArgument(t),n=new s.Deferred;return t.updateData=n.resolve,t.action=e,n},q.prototype.getStateEventArgument=function(e){var t=new s.UrlAdaptor,n=new s.DataManager({url:"",adaptor:new s.UrlAdaptor}),t=t.processQuery(n,e),n=JSON.parse(t.data);return f.extend(n,t.pvtData)},q.prototype.dataManagerSuccess=function(e,t){var n,a=this;return t?n=f.extend([],(f.isNullOrUndefined(e.result.result)?e:e.result).result,null,!0):this.parent.trigger(Q,e,function(e){n=f.extend([],(f.isNullOrUndefined(e.result.result)?e:e.result).result,null,!0),a.parent.trigger(X,null,function(){return a.parent.hideSpinner()})}),n},q.prototype.dataManagerFailure=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger(V,{error:e},function(){return t.parent.hideSpinner()})},q.prototype.onColScrollShowSkeleton=function(e){var t,n,a,e=e.target;0<this.parent.element.querySelectorAll(".e-card-skeleton-wrapper").length||(t=e.parentElement.getAttribute("data-key"),n=this.scrollStatus[t].previousScrollTop,a=e.parentElement.clientHeight,(e.scrollTop-n>a||n-e.scrollTop>a)&&this.showSkeleton(e,this.scrollStatus[t].singleIndexCardCount))},q.prototype.showSkeleton=function(e,t){var n=f.createElement("div",{className:"e-card-virtual-skeleton-wrapper",attrs:{role:"listbox"}});e.parentElement.insertBefore(n,e),n.style.position="absolute",n.style.zIndex="10";for(var a=0;a<t;a++){var r=f.createElement("div",{className:"e-card-skeleton-wrapper"}),i=f.createElement("span",{className:"e-skeleton e-skeleton-text e-shimmer-wave"});i.style.height=this.cardHeight+"px",f.isNullOrUndefined(e.querySelector(".e-card"))||(i.style.width=e.querySelector(".e-card").getBoundingClientRect().width+"px"),r.appendChild(i),n.appendChild(r)}},q.prototype.hideSkeleton=function(n){setTimeout(function(){for(var e=n.querySelectorAll(".e-card-virtual-skeleton-wrapper"),t=0;t<e.length;t++)f.detach(e[t])},50)},q.prototype.onColumnScroll=function(e){var t,n,a,r,i,o,l,s,d,c,p,h,u,g=this,m=e.target,y=m.scrollTop;m.offsetParent&&(t=m.offsetParent.getAttribute("data-key"),this.parent.scrollPosition.column[t]={left:m.scrollLeft,top:m.scrollTop}),this.parent.enableVirtualization&&(n=m,c=0,a=this.getColumnCards()[t],r=this.parent.dataModule.isRemote()?this.parent.columnDataCount[t]:a.length,c=this.cardHeight*(c+=r),u=[],o=[],this.checkScrollDirection(t,y),"fast"===this.findScrollSpeed(m,t)&&c<y||(l=this.scrollStatus[t].maxBlock,l=-1<this.scrollStatus[t].currentBlockIndex.indexOf(l),s=e.timeStamp-this.scrollStatus[t].previousTimeStamps<300,l&&!f.isNullOrUndefined(this.scrollStatus[t].previousTimeStamps)&&s)||(this.scrollStatus[t].previousTimeStamps=e.timeStamp,u=(i=this.getInfoFromView(this.scrollStatus[t])).currentBlockIndex.filter(function(e){return-1===i.newBlockIndex.indexOf(e)}),o=i.newBlockIndex.filter(function(e){return-1===i.currentBlockIndex.indexOf(e)}),s=(l=y+m.clientHeight>=c)?c-n.querySelector("."+ze).childElementCount*this.cardHeight:this.getTranslateY(i),d=n.querySelector("."+ze),0<u.length&&(c=e=void 0,c=1===u[0]?(e=0,u.length*this.scrollStatus[t].singleIndexCardCount-1):(e=(u[0]-1)*this.scrollStatus[t].singleIndexCardCount)+u.length*this.scrollStatus[t].singleIndexCardCount,this.removeCardsOnScroll(d,"down"===this.scrollStatus[t].scrollDirection,e,c)),0<o.length&&(this.parent.dataModule.isRemote()?(h=(o[0]-1)*this.scrollStatus[t].singleIndexCardCount,p=[],this.getData(this.parent.keyField,t,this.scrollStatus[t].singleIndexCardCount*o.length,h).then(function(e){p=g.dataManagerSuccess(e),g.scrollCardInsert(t,d,m,y,n,"down"===g.scrollStatus[t].scrollDirection?0:p.length-1,!0,p,null)}).catch(function(e){return g.dataManagerFailure(e)})):(h="down"===this.scrollStatus[t].scrollDirection?(o[0]-1)*this.scrollStatus[t].singleIndexCardCount:(o[0]-1)*this.scrollStatus[t].singleIndexCardCount+this.scrollStatus[t].singleIndexCardCount*o.length-1,u="down"===this.scrollStatus[t].scrollDirection?h+this.scrollStatus[t].singleIndexCardCount*o.length:(o[0]-1)*this.scrollStatus[t].singleIndexCardCount,this.scrollCardInsert(t,d,m,y,n,h,!1,a,u))),this.scrollStatus[t].currentBlockIndex=this.scrollStatus[t].newBlockIndex,this.setPadding(s,d,r,l,this.scrollStatus[t].scrollDirection),i.currentBlockIndex=i.newBlockIndex,this.parent.renderTemplates()),this.hideSkeleton(n.parentElement))},q.prototype.checkScrollDirection=function(e,t){this.scrollStatus[e].previousScrollTop=this.scrollStatus[e].currentScrollTop,(this.scrollStatus[e].currentScrollTop=t)>this.scrollStatus[e].previousScrollTop?this.scrollStatus[e].scrollDirection="down":this.scrollStatus[e].scrollDirection="up"},q.prototype.findScrollSpeed=function(e,t){return"down"===this.scrollStatus[t].scrollDirection&&e.scrollTop-this.scrollStatus[t].previousScrollTop>e.clientHeight||"up"===this.scrollStatus[t].scrollDirection&&this.scrollStatus[t].previousScrollTop-e.scrollTop>e.clientHeight?"fast":"slow"},q.prototype.removeCardsOnScroll=function(e,t,n,a){for(var r=n;r<a;r++){for(var i=t?e.firstChild:e.lastChild;!f.isNullOrUndefined(i)&&(i.classList.contains(ht)||i.classList.contains(ct)||i.classList.contains(ut)||i.classList.contains(pt));)i=t?i.nextSibling:i.previousSibling;f.isNullOrUndefined(i)||f.detach(i)}},q.prototype.scrollCardInsert=function(a,r,e,t,n,i,o,l,s){var d=this,c=o?l.length:s,p=o?0:s;if(0<l.length){for(var h=this,u=i;"down"===this.scrollStatus[a].scrollDirection?u<c:p<=u;"down"===this.scrollStatus[a].scrollDirection?u++:u--)!function(e){var t,n;f.isNullOrUndefined(l[e])||(n=l[e][h.parent.cardSettings.headerField],n=h.parent.actionModule.selectionArray.indexOf(n),t=h.renderCard(l[e]),-1!==n&&(t.setAttribute("aria-selected","true"),f.addClass([t],k)),n={data:l[e],element:t,cancel:!1},h.parent.trigger(W,n,function(e){e.cancel||("down"===d.scrollStatus[a].scrollDirection?r.appendChild(t):r.insertBefore(t,r.firstChild),d.parent.dragAndDropModule.wireDragEvents(t),f.addClass([t],C))}))}(u);e.scrollTop=t}else n.appendChild(this.renderEmptyCard())},q.prototype.ensureColumnNotEmpty=function(e){var t=this.scrollStatus[e].singleIndexCardCount,n=this.columnData[e],a=this.parent.element.querySelector('.e-content-row:not(.e-swimlane-row) [data-key="'+e+'"]').querySelector("."+ze),e=a.querySelectorAll("."+S);if(0<e.length){var r=e[e.length-1].getAttribute("data-id"),i=e[0].getAttribute("data-id"),o=void 0,l=void 0;if(e.length<2*t){for(var s=0;s<n.length;s++)r===n[s][this.parent.cardSettings.headerField].toString()&&(o=s),i===n[s][this.parent.cardSettings.headerField].toString()&&(l=s);for(s=e.length;s<2*t;s++){var d,c=o===n.length-1,p=o<n.length?o+1:l-1;p<=n.length&&(d=n[p],f.isNullOrUndefined(d)||(d=this.renderCard(d),this.triggerCardRendering(d,p,n,a,c),c?l=p:o=p))}}}},q.prototype.triggerCardRendering=function(t,e,n,a,r){var i=this,o=n[e][this.parent.cardSettings.headerField],o=(-1!==this.parent.actionModule.selectionArray.indexOf(o)&&(t.setAttribute("aria-selected","true"),f.addClass([t],k)),{data:n[e],element:t,cancel:!1});this.parent.trigger(W,o,function(e){e.cancel||(r?a.insertBefore(t,a.querySelectorAll("."+S)[0]):a.appendChild(t),i.parent.dragAndDropModule.wireDragEvents(t),f.addClass([t],C))})},q.prototype.ensureBlocks=function(e){var t=e.newBlockIndex[e.block],n=Math.ceil(e.totalColumnData/e.singleIndexCardCount),a=Math.max,e="down"===e.scrollDirection?n<=t?[a(t,1),--t,--t].reverse():n<=t+1?[a(t-1,1),t,++t]:[a(t,1),++t,++t]:t===n?[a(t-2,1),a(t-1,1),t]:[a(t-1,1),t,t+1];return e.filter(function(e){return 0<e})},q.prototype.getInfoFromView=function(e){var t,n=!1,a=e,e=(a.page=this.getPageFromTop(e),a.newBlockIndex=this.getBlockIndexes(a.page),this.ensureBlocks(a));return a.newBlockIndex.toString()!==e.toString()&&(t=e[e.length-1],-1===a.newBlockIndex.indexOf(t))&&(n=!0),a.newBlockIndex=n?e:a.newBlockIndex,a},q.prototype.getBlockIndexes=function(e){return[e+(e-1),2*e]},q.prototype.getPageFromTop=function(a){var r=this,i=a.totalColumnData,o=0;return this.offsetKeys=Object.keys(a.offsets),this.offsetKeys.some(function(e){var t,n=Number(e),e=a.currentScrollTop<=a.offsets[parseInt(e,10)]||n===i&&a.currentScrollTop>a.offsets[parseInt(e,10)];return e&&(t=Math.ceil(i/a.singleIndexCardCount),r.offsetKeys.length%2!=0&&n.toString()===r.offsetKeys[r.offsetKeys.length-2]&&a.currentScrollTop<=a.offsets[r.offsetKeys.length-1]&&(n=t<n+1?t:n+1),a.block=(n=t<n?t:n)%2==0?1:0,o=Math.max(1,Math.min(r.getPage(n,t),t))),e}),o},q.prototype.getPage=function(e,t){return t<e+1?e%2==0?e/2:(e-1)/2:e%2==0?e/2:(e+1)/2},q.prototype.onAdaptiveScroll=function(e){this.parent.touchModule.tabHold&&!this.parent.touchModule.mobilePopup&&e.preventDefault()},q.prototype.isColumnVisible=function(e){var t=this,n=!1;return"number"==typeof e.keyField?n=-1===this.parent.actionModule.hideColumnKeys.indexOf(e.keyField.toString()):e.keyField.split(",").forEach(function(e){n=-1===t.parent.actionModule.hideColumnKeys.indexOf(e)}),n},q.prototype.renderLimits=function(e,t){var n=f.createElement("div",{className:Ot});e.minCount&&n.appendChild(f.createElement("div",{className:Dt,innerHTML:this.parent.localeObj.getConstant("min")+": "+e.minCount.toString()})),e.maxCount&&n.appendChild(f.createElement("div",{className:xt,innerHTML:this.parent.localeObj.getConstant("max")+": "+e.maxCount.toString()})),0<n.childElementCount&&(t.querySelector("."+b)?t.insertBefore(n,t.firstElementChild):t.appendChild(n))},q.prototype.renderValidation=function(){var r=this;this.parent.columns.forEach(function(e){var t,n,a;(e.minCount||e.maxCount)&&(t=r.columnData[e.keyField],a='[data-key="'+e.keyField+'"]',n=r.parent.element.querySelector("."+p+a),a=[].slice.call(r.parent.element.querySelectorAll("."+u+a)),r.renderLimits(e,n),e=r.getValidationClass(e,t.length))&&f.addClass(a.concat(n),e)})},q.prototype.getValidationClass=function(e,t){var n;return e.maxCount&&t>e.maxCount?n=At:e.minCount&&t<e.minCount&&(n=Ft),n},q.prototype.refreshValidation=function(){[].slice.call(this.parent.element.querySelectorAll("."+Ot)).forEach(function(e){f.remove(e)});var e=[].slice.call(this.parent.element.querySelectorAll("."+Ft)),e=(f.removeClass(e,Ft),[].slice.call(this.parent.element.querySelectorAll("."+At)));f.removeClass(e,At),this.renderValidation()},q.prototype.getColumnData=function(t,n){var a=this,r=(void 0===n&&(n=this.parent.kanbanData),[]);if("number"==typeof t)var e=n.filter(function(e){return e[a.parent.keyField]===t}),r=r.concat(e);else for(var i=0,o=t.split(",");i<o.length;i++)!function(t){var e=n.filter(function(e){return e[a.parent.keyField]===t.trim()});r=r.concat(e)}(o[i]);return this.sortCategory(r),r},q.prototype.sortCategory=function(e){var t=this.parent.cardSettings.headerField,n=this.parent.sortSettings.direction;switch(this.parent.sortSettings.sortBy){case"DataSourceOrder":this.sortOrder(t,n,e);break;case"Custom":case"Index":this.parent.sortSettings.field&&(t=this.parent.sortSettings.field),this.sortOrder(t,n,e)}return e},q.prototype.sortOrder=function(n,e,t){var a,r,i=!0;return!(i=0<this.parent.kanbanData.length?"number"==typeof this.parent.kanbanData[0][n]:i)&&"Index"===this.parent.sortSettings.sortBy||(t=t.sort(function(e,t){return(r=i?(a=e[n],t[n]):(a=e[n].toLowerCase(),t[n].toLowerCase()))<a?1:a<r?-1:0}),"Descending"!==e)||t.reverse(),t},q.prototype.documentClick=function(e){e.target.classList.contains(wt)&&this.parent.element.querySelector("."+kt).classList.contains("e-popup-open")&&(this.treePopup.hide(),f.removeClass([this.popupOverlay],"e-enable")),f.closest(e.target,"."+Ee)||(e=[].slice.call(this.parent.element.querySelectorAll(".e-card."+k)),f.removeClass(e,k),this.disableAttributeSelection(e))},q.prototype.disableAttributeSelection=function(e){e instanceof Element?e.setAttribute("aria-selected","false"):e.forEach(function(e){e.setAttribute("aria-selected","false")})},q.prototype.getColumnCards=function(n){var a=this,r={};return this.columnKeys=[],this.parent.columns.forEach(function(e){var t="number"==typeof e.keyField,t=(a.columnKeys=t?a.columnKeys.concat(e.keyField.toString()):a.columnKeys.concat(e.keyField.split(",").map(function(e){return e.trim()})),a.getColumnData(e.keyField,n));r[e.keyField]=t}),r},q.prototype.refreshHeaders=function(){var e=this.parent.element.querySelector("."+c);[].slice.call(e.children).forEach(function(e){return f.remove(e)}),this.renderHeader(e)},q.prototype.refreshCards=function(){this.parent.resetTemplates(["cardTemplate"]),[].slice.call(this.parent.element.querySelectorAll("."+ze)).forEach(function(e){return f.remove(e)}),this.renderCards(),this.wireDragEvent(),this.parent.renderTemplates()},q.prototype.refresh=function(){var l=this,s=!1;this.parent.columns.forEach(function(e){if(e.showItemCount){e&&e.template&&!s&&(l.refreshHeaders(),s=!0);var t="."+p+'[data-key="'+e.keyField+'"] .'+Ue,t=l.parent.element.querySelector(t);if(t){var n=l.parent.dataModule.isRemote()?l.parent.columnDataCount[e.keyField]:l.columnData[e.keyField].length,a=0;if("number"==typeof e.keyField)a=[].slice.call(l.parent.element.querySelectorAll(".e-card[data-key="+e.keyField+"]")).length;else for(var r=0,i=e.keyField.split(",");r<i.length;r++)var o=i[r],a=[].slice.call(l.parent.element.querySelectorAll(".e-card[data-key="+o.trim()+"]")).length+a;t.innerHTML="- "+n+" "+l.parent.localeObj.getConstant("items")}}}),this.refreshValidation()},q.prototype.updateScrollPosition=function(){var n=this,e=this.parent.element.querySelector("."+g);e&&(f.Browser.isIE?(e.scrollTop=this.parent.scrollPosition.content.top,e.scrollLeft=this.parent.scrollPosition.content.left):e.scrollTo(this.parent.scrollPosition.content.left,this.parent.scrollPosition.content.top)),[].slice.call(this.parent.element.querySelectorAll("."+b)).forEach(function(e){var t;e.offsetParent&&(t=n.parent.scrollPosition.column[e.offsetParent.getAttribute("data-key")])&&(f.Browser.isIE?(e.scrollTop=t.top,e.scrollLeft=t.left):e.scrollTo(t.left,t.top))})},q.prototype.renderCardBasedOnIndex=function(t,n,a,r){var i,e,o,l,s=this,d=t[this.parent.keyField],c=this.parent.element.querySelector(".e-content-row:not(.e-swimlane-row)");"Index"!==this.parent.sortSettings.sortBy?(i=this.parent.cardSettings.headerField,"Custom"===this.parent.sortSettings.sortBy&&(i=this.parent.sortSettings.field),n=f.isNullOrUndefined(this.parent.swimlaneSettings.keyField)?this.getColumnData(d,this.parent.kanbanData).findIndex(function(e){return e[i]===t[i]}):(e=this.parent.getSwimlaneData(t[this.parent.swimlaneSettings.keyField]),this.getColumnData(d,e).findIndex(function(e){return e[i]===t[i]}))):"Index"===this.parent.sortSettings.sortBy&&this.parent.sortSettings.field&&"Ascending"===this.parent.sortSettings.direction&&(n=t[this.parent.sortSettings.field]-1),c&&(e=[].slice.call(c.children).filter(function(e){return-1!==e.getAttribute("data-key").replace(/\s/g,"").split(",").indexOf(d.toString().replace(/\s/g,""))})[0],(c=(o=e.querySelector("."+ze)).querySelector("."+tt))&&f.remove(c),l=this.renderCard(t),this.parent.allowDragAndDrop&&e.classList.contains(Ve)&&(this.parent.dragAndDropModule.wireDragEvents(l),f.addClass([l],C)),this.parent.trigger(W,{data:t,element:l,cancel:!1},function(e){var t=!!a||o.childNodes.length<s.scrollStatus[d].singleIndexCardCount;(e.cancel||!t)&&f.isNullOrUndefined(r)||(f.isNullOrUndefined(n)||0===o.children.length?o.appendChild(l):o.insertBefore(l,o.childNodes[n]))}))},q.prototype.removeCard=function(e){var e=e[this.parent.cardSettings.headerField],e=this.parent.element.querySelector('.e-card[data-id="'+e+'"]'),t=(this.isSelectedCard=!!e.classList.contains(k),e.parentElement);e&&f.remove(e),0===t.querySelectorAll(".e-card:not(."+pt+")").length&&t.appendChild(this.renderEmptyCard())},q.prototype.wireEvents=function(){var t=this,e=(f.EventHandler.add(this.parent.element,"click",this.parent.actionModule.clickHandler,this.parent.actionModule),f.EventHandler.add(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler,this.parent.actionModule),f.EventHandler.add(document,f.Browser.touchStartEvent,this.documentClick,this),window.addEventListener("resize",this.winResize),this.parent.element.querySelector("."+g));f.EventHandler.add(e,"scroll",this.onContentScroll,this),[].slice.call(this.parent.element.querySelectorAll("."+b)).forEach(function(e){t.parent.isInitialRender&&e.offsetParent&&(t.parent.scrollPosition.column[e.offsetParent.getAttribute("data-key")]={left:0,top:0}),f.EventHandler.add(e,"scroll",t.onColScrollShowSkeleton,t),f.EventHandler.add(e,"scroll",f.debounce(t.onColumnScroll,200),t)}),this.parent.isAdaptive&&(this.parent.touchModule.wireTouchEvents(),e.scrollLeft=this.scrollLeft),this.wireDragEvent()},q.prototype.unWireEvents=function(){var t=this,e=(f.EventHandler.remove(this.parent.element,"click",this.parent.actionModule.clickHandler),f.EventHandler.remove(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler),f.EventHandler.remove(document,f.Browser.touchStartEvent,this.documentClick),window.removeEventListener("resize",this.winResize),this.winResize=null,this.parent.element.querySelector("."+g)),e=(e&&(f.EventHandler.remove(e,"scroll",this.onContentScroll),f.EventHandler.remove(e,"scroll",this.onColScrollShowSkeleton),this.parent.allowDragAndDrop)&&this.unWireDragEvent(),[].slice.call(this.parent.element.querySelectorAll("."+b)));0<e.length&&e.forEach(function(e){f.EventHandler.remove(e,"scroll",f.debounce(t.onColumnScroll,200))}),this.parent.isAdaptive&&this.parent.touchModule.unWireTouchEvents()},q.prototype.wireDragEvent=function(){var e,t=this;this.parent.allowDragAndDrop&&(e=[].slice.call(this.parent.element.querySelectorAll("."+u+"."+Ve+" ."+S)),f.addClass(e,C),0<e.length)&&e.forEach(function(e){return t.parent.dragAndDropModule.wireDragEvents(e)})},q.prototype.unWireDragEvent=function(){var t=this,e=[].slice.call(this.parent.element.querySelectorAll("."+u+"."+Ve+" ."+S));f.removeClass(e,C),0<e.length&&e.forEach(function(e){return t.parent.dragAndDropModule.unWireDragEvents(e)})},q.prototype.destroy=function(){this.parent.resetTemplates(),this.parent.off(i,this.initRender),this.parent.off(h,this.scrollUiUpdate),this.unWireEvents();var e=this.parent.element.querySelector("."+c),e=(e&&f.remove(e),this.parent.element.querySelector("."+g)),e=(e&&f.remove(e),this.treeViewObj&&(this.treeViewObj.destroy(),this.treeViewObj=null),this.treePopup&&(this.treePopup.destroy(),this.treePopup=null),this.parent.element.querySelector("."+O)),e=(e&&f.remove(e),this.parent.element.querySelector("."+Et));e&&f.remove(e)};var Xt,Gt,Jt=q;function q(e){var t=Gt.call(this,e)||this;return t.parent=e,t.kanbanRows=[],t.scrollStatus={},t.offsets={},t.tempOffsets={},t.offsetKeys=[],t.columnKeys=[],t.scrollLeft=0,t.frozenOrder=0,t.winResize=t.windowResize.bind(t),t.parent.enableVirtualization&&(t.parent.on(i,t.initRender,t),t.parent.on(h,t.scrollUiUpdate,t)),t}Zt=function(e,t){return(Zt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};var Zt,$t,Ce=function(e,t){function n(){this.constructor=e}Zt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},R=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(o=(i<3?r(o):3<i?r(t,n,o):r(t,n))||o);return 3<i&&o&&Object.defineProperty(t,n,o),o},Ce=($t=f.Component,Ce(L,$t),L.prototype.preRender=function(){this.isAdaptive=f.Browser.isDevice,this.kanbanData=[],this.enablePersistence&&this.swimlaneToggleArray||(this.swimlaneToggleArray=[]),this.activeCardData={data:null,element:null};this.localeObj=new f.L10n(this.getModuleName(),{items:"items",min:"Min",max:"Max",cardsSelected:"Cards Selected",addTitle:"Add New Card",editTitle:"Edit Card Details",deleteTitle:"Delete Card",deleteContent:"Are you sure you want to delete this card?",save:"Save",delete:"Delete",cancel:"Cancel",yes:"Yes",no:"No",close:"Close",noCard:"No cards to display",unassigned:"Unassigned",cards:"Cards"},this.locale),this.scrollPosition={content:{left:0,top:0},column:{}},this.isInitialRender=!0},L.prototype.requiredModules=function(){return[]},L.prototype.getPersistData=function(){return 0<this.dataSource.length?this.addOnPersist(["columns","dataSource","swimlaneToggleArray"]):this.addOnPersist(["columns","kanbanData","swimlaneToggleArray"])},L.prototype.getModuleName=function(){return"kanban"},L.prototype.render=function(){var e=[Ee],t=[];(this.enableRtl?e:t).push(ke),(this.isAdaptive?e:t).push(Oe),this.cssClass&&e.push(this.cssClass),f.classList(this.element,e,t),this.element.style.width=f.formatUnit(this.width),this.element.style.height=f.formatUnit(this.height),this.element.setAttribute("role","application"),this.element.setAttribute("aria-label","Kanban Board"),P.createSpinner({target:this.element}),this.showSpinner(),this.initializeModules()},L.prototype.onPropertyChanged=function(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++)switch(a[n]){case"cssClass":t.cssClass&&f.removeClass([this.element],t.cssClass),e.cssClass&&f.addClass([this.element],e.cssClass);break;case"enableRtl":case"locale":this.refresh();break;case"width":this.element.style.width=f.formatUnit(e.width),this.element.querySelector("."+c).firstElementChild.style.width="auto",this.notify(h,{});break;case"height":this.element.style.height=f.formatUnit(e.height),this.element.querySelector("."+g).style.height="auto",this.notify(h,{});break;case"dataSource":case"query":this.dataModule&&this.dataModule.setState({isDataChanged:!1}),this.dataModule=new ae(this);break;case"columns":case"constraintType":this.notify(i,{processedData:this.kanbanData});break;case"swimlaneSettings":this.onSwimlaneSettingsPropertyChanged(e.swimlaneSettings,t.swimlaneSettings);break;case"cardSettings":this.onCardSettingsPropertyChanged(e.cardSettings,t.cardSettings);break;case"allowDragAndDrop":e.allowDragAndDrop?(this.enableVirtualization?this.virtualLayoutModule:this.layoutModule).wireDragEvent():(this.enableVirtualization?this.virtualLayoutModule:this.layoutModule).unWireDragEvent();break;case"enableTooltip":this.tooltipModule&&(this.tooltipModule.destroy(),this.tooltipModule=null),e.enableTooltip&&(this.tooltipModule=new zt(this),(this.enableVirtualization?this.virtualLayoutModule:this.layoutModule).refreshCards());break;case"dialogSettings":e.dialogSettings&&(this.dialogModule=new Bt(this));break;case"allowKeyboard":this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),e.allowKeyboard&&(this.keyboardModule=new Ut(this));break;case"stackedHeaders":(this.enableVirtualization?this.virtualLayoutModule:this.layoutModule).refreshHeaders();break;case"sortSettings":this.notify(i,{processedData:this.kanbanData})}},L.prototype.onSwimlaneSettingsPropertyChanged=function(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++)switch(a[n]){case"keyField":case"textField":case"showEmptyRow":case"showItemCount":case"template":case"sortDirection":this.notify(i,{processedData:this.kanbanData});break;case"enableFrozenRows":this.layoutModule.frozenSwimlaneRow&&!this.swimlaneSettings.enableFrozenRows&&this.layoutModule.removeFrozenRows()}},L.prototype.onCardSettingsPropertyChanged=function(e,t){for(var n,a=0,r=Object.keys(e);a<r.length;a++)switch(r[a]){case"showHeader":case"headerField":case"contentField":case"template":case"tagsField":case"grabberField":case"footerCssField":(this.enableVirtualization?this.virtualLayoutModule:this.layoutModule).refreshCards();break;case"selectionType":0<(n=this.getSelectedCards()).length&&(f.removeClass(n,k),(this.enableVirtualization?this.virtualLayoutModule:this.layoutModule).disableAttributeSelection(n))}},L.prototype.initializeModules=function(){this.dataModule=new ae(this),this.enableVirtualization?this.virtualLayoutModule=new Jt(this):this.layoutModule=new Qt(this),this.allowKeyboard&&(this.keyboardModule=new Ut(this)),this.actionModule=new Pt(this),this.crudModule=new Nt(this),this.dragAndDropModule=new It(this),this.dialogModule=new Bt(this),this.enableTooltip&&(this.tooltipModule=new zt(this)),(f.Browser.isDevice||f.Browser.isTouch)&&(this.touchModule=new _t(this))},L.prototype.renderTemplates=function(){this.isReact&&this.renderReactTemplates()},L.prototype.resetTemplates=function(e){this.isReact&&this.clearTemplate(e)},L.prototype.destroyModules=function(){this.layoutModule&&(this.layoutModule.destroy(),this.layoutModule=null),this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),this.touchModule&&(this.touchModule.destroy(),this.touchModule=null),this.tooltipModule&&(this.tooltipModule.destroy(),this.tooltipModule=null),this.virtualLayoutModule&&(this.virtualLayoutModule.destroy(),this.virtualLayoutModule=null),this.dialogModule=null,this.actionModule=null,this.crudModule=null,this.dataModule=null,this.dragAndDropModule=null},L.prototype.templateParser=function(t){if(t)try{return"function"!=typeof t&&document.querySelectorAll(t).length?f.compile(document.querySelector(t).innerHTML.trim()):f.compile(t)}catch(e){return f.compile(t)}},L.prototype.getCardDetails=function(e){var t=this,n="number"==typeof this.kanbanData[0][this.cardSettings.headerField]?parseInt(e.getAttribute("data-id"),10):e.getAttribute("data-id");return this.kanbanData.filter(function(e){return e[t.cardSettings.headerField]===n})[0]},L.prototype.getColumnData=function(e,t){return this.enableVirtualization?this.virtualLayoutModule.getColumnCards(t)[""+e]||[]:this.layoutModule.getColumnCards(t)[""+e]||[]},L.prototype.getSwimlaneData=function(e){return this.layoutModule.getSwimlaneCards()[""+e]||[]},L.prototype.getSelectedCards=function(){return[].slice.call(this.element.querySelectorAll(".e-card."+k))},L.prototype.showSpinner=function(){P.showSpinner(this.element)},L.prototype.hideSpinner=function(){P.hideSpinner(this.element)},L.prototype.openDialog=function(e,t){this.dialogModule.openDialog(e,t)},L.prototype.closeDialog=function(){this.dialogModule.closeDialog()},L.prototype.addCard=function(e,t){this.crudModule.addCard(e,t)},L.prototype.updateCard=function(e,t){this.crudModule.updateCard(e,t)},L.prototype.deleteCard=function(e){this.crudModule.deleteCard(e)},L.prototype.addColumn=function(e,t){this.actionModule.addColumn(e,t)},L.prototype.deleteColumn=function(e){this.actionModule.deleteColumn(e)},L.prototype.showColumn=function(e){this.actionModule.showColumn(e)},L.prototype.hideColumn=function(e){this.actionModule.hideColumn(e)},L.prototype.refreshUI=function(e,t){this.dataModule.refreshUI(e,t=t||0)},L.prototype.refreshHeader=function(){this.resetTemplates(["columnTemplate"]),(this.enableVirtualization?this.virtualLayoutModule:this.layoutModule).refreshHeaders(),this.renderTemplates()},L.prototype.destroy=function(){this.destroyModules(),[].slice.call(this.element.childNodes).forEach(function(e){f.detach(e)});var e=[Ee];this.cssClass&&(e=e.concat(this.cssClass.split(" "))),f.removeClass([this.element],e),$t.prototype.destroy.call(this)},R([f.Property()],L.prototype,"cssClass",void 0),R([f.Property("auto")],L.prototype,"width",void 0),R([f.Property("auto")],L.prototype,"height",void 0),R([f.Property("auto")],L.prototype,"cardHeight",void 0),R([f.Property()],L.prototype,"enableVirtualization",void 0),R([f.Property([])],L.prototype,"dataSource",void 0),R([f.Property()],L.prototype,"query",void 0),R([f.Property()],L.prototype,"keyField",void 0),R([f.Property("Column")],L.prototype,"constraintType",void 0),R([f.Property([])],L.prototype,"externalDropId",void 0),R([f.Collection([],me)],L.prototype,"columns",void 0),R([f.Property(!0)],L.prototype,"allowKeyboard",void 0),R([f.Property(!0)],L.prototype,"enableHtmlSanitizer",void 0),R([f.Collection([],pe)],L.prototype,"stackedHeaders",void 0),R([f.Complex({},oe)],L.prototype,"swimlaneSettings",void 0),R([f.Complex({},n)],L.prototype,"cardSettings",void 0),R([f.Complex({},l)],L.prototype,"sortSettings",void 0),R([f.Complex({},r)],L.prototype,"dialogSettings",void 0),R([f.Property(!0)],L.prototype,"allowDragAndDrop",void 0),R([f.Property(!1)],L.prototype,"enableTooltip",void 0),R([f.Property(!1)],L.prototype,"showEmptyColumn",void 0),R([f.Property(!1)],L.prototype,"enablePersistence",void 0),R([f.Property()],L.prototype,"tooltipTemplate",void 0),R([f.Event()],L.prototype,"actionBegin",void 0),R([f.Event()],L.prototype,"actionComplete",void 0),R([f.Event()],L.prototype,"actionFailure",void 0),R([f.Event()],L.prototype,"created",void 0),R([f.Event()],L.prototype,"dataBinding",void 0),R([f.Event()],L.prototype,"dataBound",void 0),R([f.Event()],L.prototype,"cardClick",void 0),R([f.Event()],L.prototype,"cardDoubleClick",void 0),R([f.Event()],L.prototype,"queryCellInfo",void 0),R([f.Event()],L.prototype,"cardRendered",void 0),R([f.Event()],L.prototype,"dragStart",void 0),R([f.Event()],L.prototype,"drag",void 0),R([f.Event()],L.prototype,"dragStop",void 0),R([f.Event()],L.prototype,"dialogOpen",void 0),R([f.Event()],L.prototype,"dialogClose",void 0),R([f.Event()],L.prototype,"dataStateChange",void 0),R([f.Event()],L.prototype,"dataSourceChanged",void 0),R([f.NotifyPropertyChanges],L));function L(e,t){e=$t.call(this,e,t)||this;return e.columnDataCount={},e.needsID=!0,e}e.Kanban=Ce,e.actionBegin=U,e.actionComplete=z,e.actionFailure=V,e.bottomSpace=25,e.cardClick=_,e.cardDoubleClick=K,e.cardRendered=W,e.cardSpace=16,e.contentReady=h,e.dataBinding=Q,e.dataBound=X,e.dataReady=i,e.dataSourceChanged=te,e.dataStateChange=ne,e.dialogClose=ee,e.dialogOpen=$,e.documentClick="document-click",e.drag=J,e.dragStart=G,e.dragStop=Z,e.queryCellInfo=Y,e.toggleWidth=50,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-kanban.umd.min.js.map
